_anchors:
  file_extensions: &id001
  - tf
  security: &id002
    checkov:
      command: checkov -d . --download-external-modules True --framework terraform --skip-download --output
        json --output-file-path ${CHECKOV_JSON_REPORT_PATH}/checkov.json,
      customizations: &id003
        CHECKOV_BASELINE: --baseline
        CHECKOV_EXTERNAL_CHECKS_DIR: --external-checks-dir
        CHECKOV_SKIP_CHECK: --skip-check
      description: directory scan
  validation: &id004
  - command: terraform init -backend=false
    description: initialization
  - command: terraform validate
    description: validation
environments:
  aws:
    packages:
    - aws-cli
  azure:
    packages:
    - azure-cli
packages:
  ansible:
    aliases:
    - ansible
    - ansible-playbook
    security:
      kics:
        command: kics scan --type Ansible --no-progress --queries-path ${KICS_INCLUDE_QUERIES_PATH}
          --libraries-path ${KICS_LIBRARY_PATH} --report-formats json --output-path
          ${KICS_REPORTS} --output-name kics --path .
        customizations:
          KICS_EXCLUDE_SEVERITIES: --exclude-severities
          KICS_INCLUDE_QUERIES: --include-queries
        description: directory scan
    version: 2.9.6+dfsg-1
    version_argument: --version
  aws-cli:
    aliases:
    - aws
    allow_filter:
    - match: cloudformation
      position: 1
    security:
      checkov:
        command: checkov -d . --framework cloudformation --skip-download --output
          json --output-file-path ${CHECKOV_JSON_REPORT_PATH}/checkov.json,
        customizations: *id003
        description: directory scan
    tool:
      name: cloudformation
      environments:
        - none
    version: 2.11.8
    version_argument: --version
  azure-cli:
    aliases:
    - az
    version: 2.46.0-1~focal
    version_argument: version
  checkov:
    version: 2.3.148
    version_argument: --version
  consul-template:
    helper:
    - all
    version: v0.30.0
    version_argument: --version
  envconsul:
    helper:
    - all
    version: v0.13.1
    version_argument: --version
  fluent-bit:
    helper:
    - all
    version: v2.0.10
    version_argument: --version
  kics:
    version: v1.6.13
    version_argument: version
  terraform:
    file_extensions: *id001
    security: *id002
    validation: *id004
    version: 1.4.4
    version_argument: version
  terratag:
    helper:
    - terraform
    version: v0.2.0
  tfenv:
    allow_filter:
    - match: exec
      position: 0
    file_extensions: *id001
    helper:
    - terraform
    security: *id002
    validation: *id004
    version: v3.0.0
    version_argument: --version
