_anchors:
  security: &id001
    checkov:
      command: checkov -d . --no-guide
      description: directory scan
    kics:
      command: kics scan --type Terraform --no-progress --queries-path ${KICS_QUERIES_PATH}
        --libraries-path ${KICS_LIBRARY_PATH} --report-formats json --output-path ${KICS_JSON_REPORT_PATH}
        --output-name kics --path .
      customizations:
        KICS_QUERIES: --include-queries
        KICS_EXCLUDE_SEVERITIES: --exclude-severities
      description: directory scan
    terrascan:
      command: terrascan scan -i terraform -t all -d .
      description: recursive scan
    tfsec:
      command: tfsec .
      description: recursive scan
  validation: &id002
  - command: terraform init -backend=false
    description: initialization
  - command: terraform validate
    description: validation
  file_extensions: &id003
    - tf
commands:
  ansible:
    aliases:
    - ansible
    - ansible-playbook
    security:
      kics:
        command: kics scan --type Ansible --no-progress --queries-path ${KICS_QUERIES_PATH}
          --libraries-path ${KICS_LIBRARY_PATH} --report-formats json --output-path ${KICS_REPORTS}
          --output-name kics --path .
        customizations:
          KICS_QUERIES: --include-queries
          KICS_EXCLUDE_SEVERITIES: --exclude-severities
        description: directory scan
    version: 2.9.6+dfsg-1
    version_argument: --version
  aws-cli:
    aliases:
    - aws
    version: 2.2.34
    version_argument: --version
  azure-cli:
    aliases:
    - az
    version: 2.27.2-1~focal
    version_argument: version
  checkov:
    version: 2.0.392
    version_argument: --version
  fluent-bit:
    version: v1.8.6
    version_argument: --version
  kics:
    version: v1.4.2
    version_argument: version
  packer:
    version: 1.7.4
    version_argument: version
  terraform:
    file_extensions: *id003
    security: *id001
    validation: *id002
    version: 1.0.5
    version_argument: version
  terrascan:
    version: v1.10.0
    version_argument: version
  tfenv:
    allow_filter:
    - match: exec
      position: 0
    file_extensions: *id003
    security: *id001
    validation: *id002
    version: v2.2.2
    version_argument: --version
  tfsec:
    version: v0.58.6
    version_argument: --version
