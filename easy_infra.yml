_anchors:
  file_extensions: &id003
  - tf
  security: &id004
    checkov:
      arg_customizations: &id001
        CHECKOV_BASELINE: --baseline
        CHECKOV_EXTERNAL_CHECKS_DIR: --external-checks-dir
        CHECKOV_SKIP_CHECK: --skip-check
      command: checkov -d . --download-external-modules True --framework terraform
        --skip-download --output cli --output json --output-file-path console,${CHECKOV_JSON_REPORT_PATH}/checkov.json
      description: directory scan
      env_customizations: &id002
        CHECKOV_LOG_LEVEL: LOG_LEVEL
environments:
  aws:
    packages:
    - aws-cli
  azure:
    packages:
    - azure-cli
packages:
  ansible:
    aliases:
    - ansible
    - ansible-playbook
    security:
      kics:
        arg_customizations:
          KICS_EXCLUDE_SEVERITIES: --exclude-severities
          KICS_INCLUDE_QUERIES: --include-queries
        command: kics scan --type Ansible --no-progress --queries-path ${KICS_INCLUDE_QUERIES_PATH}
          --libraries-path ${KICS_LIBRARY_PATH} --report-formats json --output-path
          ${KICS_REPORTS} --output-name kics --path .
        description: directory scan
    version: 2.10.7+merged+base+2.10.8+dfsg-1
    version_argument: --version
  aws-cli:
    aliases:
    - aws
    allow_filter:
    - match: cloudformation
      position: 0
    security:
      checkov:
        arg_customizations: *id001
        command: checkov -d . --framework cloudformation --skip-download --output
          cli --output json --output-file-path console,${CHECKOV_JSON_REPORT_PATH}/checkov.json
        description: directory scan
        env_customizations: *id002
    tool:
      environments:
      - none
      name: cloudformation
    version: 2.13.20
    version_argument: --version
  azure-cli:
    aliases:
    - az
    version: 2.52.0-1~jammy
    version_argument: version
  checkov:
    version: 2.4.47
    version_argument: --version
  consul-template:
    helper:
    - all
    version: v0.33.0
    version_argument: --version
  envconsul:
    helper:
    - all
    version: v0.13.2
    version_argument: --version
  fluent-bit:
    helper:
    - all
    version: v2.1.9
    version_argument: --version
  git:
    helper:
    - all
    version: v2.42.0
    version_argument: --version
  kics:
    version: v1.7.8
    version_argument: version
  terraform:
    file_extensions: *id003
    monitor:
      env_vars:
      - TF_DATA_DIR
    security: *id004
    version: 1.5.7
    version_argument: version
  terratag:
    helper:
    - terraform
    version: v0.2.3
  tfenv:
    allow_filter:
    - match: exec
      position: 0
    file_extensions: *id003
    helper:
    - terraform
    monitor:
      env_vars:
      - TF_DATA_DIR
    security: *id004
    version: v3.0.0
    version_argument: --version
