_anchors:
  security: &terraform-security
    checkov:
      command: checkov -d . --no-guide
      description: directory scan
    terrascan:
      command: terrascan scan -i terraform -t all -d .
      description: recursive scan
    tfsec:
      command: tfsec .
      description: recursive scan
  validation: &terraform-validation
  - command: terraform init
    description: initialization
  - command: terraform validate
    description: validation
commands:
  ansible:
    version: 2.9.6+dfsg-1
    version_command: ansible --version
  awscli:
    version: 1.19.60
    version_command: aws --version
  azure-cli:
    version: 2.22.1-1~focal
    version_command: az version
  checkov:
    version: 2.0.87
    version_command: checkov --version
  packer:
    version: 1.7.2
    version_command: packer version
  terraform:
    security: *terraform-security
    validation: *terraform-validation
    version: 0.15.1
    version_command: terraform version
  terrascan:
    version: v1.3.1
    version_command: terrascan version
  tfenv:
    allow_filter:
    - match: exec
      position: 0
    security: *terraform-security
    validation: *terraform-validation
    version: v2.2.1
    version_command: tfenv --version
  tfsec:
    version: v0.39.26
    version_command: tfsec --version
