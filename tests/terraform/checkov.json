{"check_type": "terraform", "results": {"passed_checks": [{"check_id": "CKV_AWS_41", "bc_check_id": null, "check_name": "Ensure no hard coded AWS access key and secret key exists in provider", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[1, "provider \"aws\" {\n"], [2, "  region = local.region\n"], [3, "\n"], [4, "  # Make it faster by skipping something\n"], [5, "  skip_get_ec2_platforms      = true\n"], [6, "  skip_metadata_api_check     = true\n"], [7, "  skip_region_validation      = true\n"], [8, "  skip_credentials_validation = true\n"], [9, "  skip_requesting_account_id  = true\n"], [10, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [1, 10], "resource": "aws.default", "evaluations": null, "check_class": "checkov.terraform.checks.provider.aws.credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf"}, {"check_id": "CKV_AWS_1", "bc_check_id": null, "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[48, "data \"aws_iam_policy_document\" \"bucket_policy\" {\n"], [49, "  statement {\n"], [50, "    principals {\n"], [51, "      type        = \"AWS\"\n"], [52, "      identifiers = [aws_iam_role.this.arn]\n"], [53, "    }\n"], [54, "\n"], [55, "    actions = [\n"], [56, "      \"s3:ListBucket\",\n"], [57, "    ]\n"], [58, "\n"], [59, "    resources = [\n"], [60, "      \"arn:aws:s3:::${local.bucket_name}\",\n"], [61, "    ]\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [48, 63], "resource": "aws_iam_policy_document.bucket_policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.AdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "breadcrumbs": {"statement.resources.0": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}], "statement.resources": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_49", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[48, "data \"aws_iam_policy_document\" \"bucket_policy\" {\n"], [49, "  statement {\n"], [50, "    principals {\n"], [51, "      type        = \"AWS\"\n"], [52, "      identifiers = [aws_iam_role.this.arn]\n"], [53, "    }\n"], [54, "\n"], [55, "    actions = [\n"], [56, "      \"s3:ListBucket\",\n"], [57, "    ]\n"], [58, "\n"], [59, "    resources = [\n"], [60, "      \"arn:aws:s3:::${local.bucket_name}\",\n"], [61, "    ]\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [48, 63], "resource": "aws_iam_policy_document.bucket_policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.StarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "breadcrumbs": {"statement.resources.0": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}], "statement.resources": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_110", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[48, "data \"aws_iam_policy_document\" \"bucket_policy\" {\n"], [49, "  statement {\n"], [50, "    principals {\n"], [51, "      type        = \"AWS\"\n"], [52, "      identifiers = [aws_iam_role.this.arn]\n"], [53, "    }\n"], [54, "\n"], [55, "    actions = [\n"], [56, "      \"s3:ListBucket\",\n"], [57, "    ]\n"], [58, "\n"], [59, "    resources = [\n"], [60, "      \"arn:aws:s3:::${local.bucket_name}\",\n"], [61, "    ]\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [48, 63], "resource": "aws_iam_policy_document.bucket_policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "breadcrumbs": {"statement.resources.0": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}], "statement.resources": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_111", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[48, "data \"aws_iam_policy_document\" \"bucket_policy\" {\n"], [49, "  statement {\n"], [50, "    principals {\n"], [51, "      type        = \"AWS\"\n"], [52, "      identifiers = [aws_iam_role.this.arn]\n"], [53, "    }\n"], [54, "\n"], [55, "    actions = [\n"], [56, "      \"s3:ListBucket\",\n"], [57, "    ]\n"], [58, "\n"], [59, "    resources = [\n"], [60, "      \"arn:aws:s3:::${local.bucket_name}\",\n"], [61, "    ]\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [48, 63], "resource": "aws_iam_policy_document.bucket_policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "breadcrumbs": {"statement.resources.0": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}], "statement.resources": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_107", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[48, "data \"aws_iam_policy_document\" \"bucket_policy\" {\n"], [49, "  statement {\n"], [50, "    principals {\n"], [51, "      type        = \"AWS\"\n"], [52, "      identifiers = [aws_iam_role.this.arn]\n"], [53, "    }\n"], [54, "\n"], [55, "    actions = [\n"], [56, "      \"s3:ListBucket\",\n"], [57, "    ]\n"], [58, "\n"], [59, "    resources = [\n"], [60, "      \"arn:aws:s3:::${local.bucket_name}\",\n"], [61, "    ]\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [48, 63], "resource": "aws_iam_policy_document.bucket_policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "breadcrumbs": {"statement.resources.0": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}], "statement.resources": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_108", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[48, "data \"aws_iam_policy_document\" \"bucket_policy\" {\n"], [49, "  statement {\n"], [50, "    principals {\n"], [51, "      type        = \"AWS\"\n"], [52, "      identifiers = [aws_iam_role.this.arn]\n"], [53, "    }\n"], [54, "\n"], [55, "    actions = [\n"], [56, "      \"s3:ListBucket\",\n"], [57, "    ]\n"], [58, "\n"], [59, "    resources = [\n"], [60, "      \"arn:aws:s3:::${local.bucket_name}\",\n"], [61, "    ]\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [48, 63], "resource": "aws_iam_policy_document.bucket_policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "breadcrumbs": {"statement.resources.0": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}], "statement.resources": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_109", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[48, "data \"aws_iam_policy_document\" \"bucket_policy\" {\n"], [49, "  statement {\n"], [50, "    principals {\n"], [51, "      type        = \"AWS\"\n"], [52, "      identifiers = [aws_iam_role.this.arn]\n"], [53, "    }\n"], [54, "\n"], [55, "    actions = [\n"], [56, "      \"s3:ListBucket\",\n"], [57, "    ]\n"], [58, "\n"], [59, "    resources = [\n"], [60, "      \"arn:aws:s3:::${local.bucket_name}\",\n"], [61, "    ]\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [48, 63], "resource": "aws_iam_policy_document.bucket_policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "breadcrumbs": {"statement.resources.0": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}], "statement.resources": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_283", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[48, "data \"aws_iam_policy_document\" \"bucket_policy\" {\n"], [49, "  statement {\n"], [50, "    principals {\n"], [51, "      type        = \"AWS\"\n"], [52, "      identifiers = [aws_iam_role.this.arn]\n"], [53, "    }\n"], [54, "\n"], [55, "    actions = [\n"], [56, "      \"s3:ListBucket\",\n"], [57, "    ]\n"], [58, "\n"], [59, "    resources = [\n"], [60, "      \"arn:aws:s3:::${local.bucket_name}\",\n"], [61, "    ]\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [48, 63], "resource": "aws_iam_policy_document.bucket_policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPublichActionsPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "breadcrumbs": {"statement.resources.0": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}], "statement.resources": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_33", "bc_check_id": null, "check_name": "Ensure KMS key policy does not contain wildcard (*) principal", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[25, "resource \"aws_kms_key\" \"objects\" {\n"], [26, "  description             = \"KMS key is used to encrypt bucket objects\"\n"], [27, "  deletion_window_in_days = 7\n"], [28, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [25, 28], "resource": "aws_kms_key.objects", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSKeyWildcardPrincipal", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf"}, {"check_id": "CKV_AWS_227", "bc_check_id": null, "check_name": "Ensure KMS key is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["is_enabled"]}, "code_block": [[25, "resource \"aws_kms_key\" \"objects\" {\n"], [26, "  description             = \"KMS key is used to encrypt bucket objects\"\n"], [27, "  deletion_window_in_days = 7\n"], [28, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [25, 28], "resource": "aws_kms_key.objects", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSKeyIsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": null, "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[30, "resource \"aws_iam_role\" \"this\" {\n"], [31, "  assume_role_policy = <<EOF\n"], [32, "{\n"], [33, "  \"Version\": \"2012-10-17\",\n"], [34, "  \"Statement\": [\n"], [35, "    {\n"], [36, "      \"Action\": \"sts:AssumeRole\",\n"], [37, "      \"Principal\": {\n"], [38, "        \"Service\": \"ec2.amazonaws.com\"\n"], [39, "      },\n"], [40, "      \"Effect\": \"Allow\",\n"], [41, "      \"Sid\": \"\"\n"], [42, "    }\n"], [43, "  ]\n"], [44, "}\n"], [45, "EOF\n"], [46, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [30, 46], "resource": "aws_iam_role.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[30, "resource \"aws_iam_role\" \"this\" {\n"], [31, "  assume_role_policy = <<EOF\n"], [32, "{\n"], [33, "  \"Version\": \"2012-10-17\",\n"], [34, "  \"Statement\": [\n"], [35, "    {\n"], [36, "      \"Action\": \"sts:AssumeRole\",\n"], [37, "      \"Principal\": {\n"], [38, "        \"Service\": \"ec2.amazonaws.com\"\n"], [39, "      },\n"], [40, "      \"Effect\": \"Allow\",\n"], [41, "      \"Sid\": \"\"\n"], [42, "    }\n"], [43, "  ]\n"], [44, "}\n"], [45, "EOF\n"], [46, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [30, 46], "resource": "aws_iam_role.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": null, "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[30, "resource \"aws_iam_role\" \"this\" {\n"], [31, "  assume_role_policy = <<EOF\n"], [32, "{\n"], [33, "  \"Version\": \"2012-10-17\",\n"], [34, "  \"Statement\": [\n"], [35, "    {\n"], [36, "      \"Action\": \"sts:AssumeRole\",\n"], [37, "      \"Principal\": {\n"], [38, "        \"Service\": \"ec2.amazonaws.com\"\n"], [39, "      },\n"], [40, "      \"Effect\": \"Allow\",\n"], [41, "      \"Sid\": \"\"\n"], [42, "    }\n"], [43, "  ]\n"], [44, "}\n"], [45, "EOF\n"], [46, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [30, 46], "resource": "aws_iam_role.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf"}, {"check_id": "CKV_AWS_1", "bc_check_id": null, "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.AdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_49", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.StarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_110", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_111", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_107", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_108", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_109", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_283", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPublichActionsPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_1", "bc_check_id": null, "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[291, "data \"aws_iam_policy_document\" \"elb_log_delivery\" {\n"], [292, "  count = local.create_bucket && var.attach_elb_log_delivery_policy ? 1 : 0\n"], [293, "\n"], [294, "  statement {\n"], [295, "    sid = \"\"\n"], [296, "\n"], [297, "    principals {\n"], [298, "      type        = \"AWS\"\n"], [299, "      identifiers = data.aws_elb_service_account.this.*.arn\n"], [300, "    }\n"], [301, "\n"], [302, "    effect = \"Allow\"\n"], [303, "\n"], [304, "    actions = [\n"], [305, "      \"s3:PutObject\",\n"], [306, "    ]\n"], [307, "\n"], [308, "    resources = [\n"], [309, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [310, "    ]\n"], [311, "  }\n"], [312, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [291, 312], "resource": "module.log_bucket.aws_iam_policy_document.elb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.AdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_elb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_49", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[291, "data \"aws_iam_policy_document\" \"elb_log_delivery\" {\n"], [292, "  count = local.create_bucket && var.attach_elb_log_delivery_policy ? 1 : 0\n"], [293, "\n"], [294, "  statement {\n"], [295, "    sid = \"\"\n"], [296, "\n"], [297, "    principals {\n"], [298, "      type        = \"AWS\"\n"], [299, "      identifiers = data.aws_elb_service_account.this.*.arn\n"], [300, "    }\n"], [301, "\n"], [302, "    effect = \"Allow\"\n"], [303, "\n"], [304, "    actions = [\n"], [305, "      \"s3:PutObject\",\n"], [306, "    ]\n"], [307, "\n"], [308, "    resources = [\n"], [309, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [310, "    ]\n"], [311, "  }\n"], [312, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [291, 312], "resource": "module.log_bucket.aws_iam_policy_document.elb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.StarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_elb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_110", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[291, "data \"aws_iam_policy_document\" \"elb_log_delivery\" {\n"], [292, "  count = local.create_bucket && var.attach_elb_log_delivery_policy ? 1 : 0\n"], [293, "\n"], [294, "  statement {\n"], [295, "    sid = \"\"\n"], [296, "\n"], [297, "    principals {\n"], [298, "      type        = \"AWS\"\n"], [299, "      identifiers = data.aws_elb_service_account.this.*.arn\n"], [300, "    }\n"], [301, "\n"], [302, "    effect = \"Allow\"\n"], [303, "\n"], [304, "    actions = [\n"], [305, "      \"s3:PutObject\",\n"], [306, "    ]\n"], [307, "\n"], [308, "    resources = [\n"], [309, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [310, "    ]\n"], [311, "  }\n"], [312, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [291, 312], "resource": "module.log_bucket.aws_iam_policy_document.elb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_elb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_111", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[291, "data \"aws_iam_policy_document\" \"elb_log_delivery\" {\n"], [292, "  count = local.create_bucket && var.attach_elb_log_delivery_policy ? 1 : 0\n"], [293, "\n"], [294, "  statement {\n"], [295, "    sid = \"\"\n"], [296, "\n"], [297, "    principals {\n"], [298, "      type        = \"AWS\"\n"], [299, "      identifiers = data.aws_elb_service_account.this.*.arn\n"], [300, "    }\n"], [301, "\n"], [302, "    effect = \"Allow\"\n"], [303, "\n"], [304, "    actions = [\n"], [305, "      \"s3:PutObject\",\n"], [306, "    ]\n"], [307, "\n"], [308, "    resources = [\n"], [309, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [310, "    ]\n"], [311, "  }\n"], [312, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [291, 312], "resource": "module.log_bucket.aws_iam_policy_document.elb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_elb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_107", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[291, "data \"aws_iam_policy_document\" \"elb_log_delivery\" {\n"], [292, "  count = local.create_bucket && var.attach_elb_log_delivery_policy ? 1 : 0\n"], [293, "\n"], [294, "  statement {\n"], [295, "    sid = \"\"\n"], [296, "\n"], [297, "    principals {\n"], [298, "      type        = \"AWS\"\n"], [299, "      identifiers = data.aws_elb_service_account.this.*.arn\n"], [300, "    }\n"], [301, "\n"], [302, "    effect = \"Allow\"\n"], [303, "\n"], [304, "    actions = [\n"], [305, "      \"s3:PutObject\",\n"], [306, "    ]\n"], [307, "\n"], [308, "    resources = [\n"], [309, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [310, "    ]\n"], [311, "  }\n"], [312, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [291, 312], "resource": "module.log_bucket.aws_iam_policy_document.elb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_elb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_108", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[291, "data \"aws_iam_policy_document\" \"elb_log_delivery\" {\n"], [292, "  count = local.create_bucket && var.attach_elb_log_delivery_policy ? 1 : 0\n"], [293, "\n"], [294, "  statement {\n"], [295, "    sid = \"\"\n"], [296, "\n"], [297, "    principals {\n"], [298, "      type        = \"AWS\"\n"], [299, "      identifiers = data.aws_elb_service_account.this.*.arn\n"], [300, "    }\n"], [301, "\n"], [302, "    effect = \"Allow\"\n"], [303, "\n"], [304, "    actions = [\n"], [305, "      \"s3:PutObject\",\n"], [306, "    ]\n"], [307, "\n"], [308, "    resources = [\n"], [309, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [310, "    ]\n"], [311, "  }\n"], [312, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [291, 312], "resource": "module.log_bucket.aws_iam_policy_document.elb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_elb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_109", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[291, "data \"aws_iam_policy_document\" \"elb_log_delivery\" {\n"], [292, "  count = local.create_bucket && var.attach_elb_log_delivery_policy ? 1 : 0\n"], [293, "\n"], [294, "  statement {\n"], [295, "    sid = \"\"\n"], [296, "\n"], [297, "    principals {\n"], [298, "      type        = \"AWS\"\n"], [299, "      identifiers = data.aws_elb_service_account.this.*.arn\n"], [300, "    }\n"], [301, "\n"], [302, "    effect = \"Allow\"\n"], [303, "\n"], [304, "    actions = [\n"], [305, "      \"s3:PutObject\",\n"], [306, "    ]\n"], [307, "\n"], [308, "    resources = [\n"], [309, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [310, "    ]\n"], [311, "  }\n"], [312, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [291, 312], "resource": "module.log_bucket.aws_iam_policy_document.elb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_elb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_283", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[291, "data \"aws_iam_policy_document\" \"elb_log_delivery\" {\n"], [292, "  count = local.create_bucket && var.attach_elb_log_delivery_policy ? 1 : 0\n"], [293, "\n"], [294, "  statement {\n"], [295, "    sid = \"\"\n"], [296, "\n"], [297, "    principals {\n"], [298, "      type        = \"AWS\"\n"], [299, "      identifiers = data.aws_elb_service_account.this.*.arn\n"], [300, "    }\n"], [301, "\n"], [302, "    effect = \"Allow\"\n"], [303, "\n"], [304, "    actions = [\n"], [305, "      \"s3:PutObject\",\n"], [306, "    ]\n"], [307, "\n"], [308, "    resources = [\n"], [309, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [310, "    ]\n"], [311, "  }\n"], [312, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [291, 312], "resource": "module.log_bucket.aws_iam_policy_document.elb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPublichActionsPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_elb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_1", "bc_check_id": null, "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[316, "data \"aws_iam_policy_document\" \"lb_log_delivery\" {\n"], [317, "  count = local.create_bucket && var.attach_lb_log_delivery_policy ? 1 : 0\n"], [318, "\n"], [319, "  statement {\n"], [320, "    sid = \"AWSLogDeliveryWrite\"\n"], [321, "\n"], [322, "    principals {\n"], [323, "      type        = \"Service\"\n"], [324, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [325, "    }\n"], [326, "\n"], [327, "    effect = \"Allow\"\n"], [328, "\n"], [329, "    actions = [\n"], [330, "      \"s3:PutObject\",\n"], [331, "    ]\n"], [332, "\n"], [333, "    resources = [\n"], [334, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [335, "    ]\n"], [336, "\n"], [337, "    condition {\n"], [338, "      test     = \"StringEquals\"\n"], [339, "      variable = \"s3:x-amz-acl\"\n"], [340, "      values   = [\"bucket-owner-full-control\"]\n"], [341, "    }\n"], [342, "  }\n"], [343, "\n"], [344, "  statement {\n"], [345, "    sid = \"AWSLogDeliveryAclCheck\"\n"], [346, "\n"], [347, "    effect = \"Allow\"\n"], [348, "\n"], [349, "    principals {\n"], [350, "      type        = \"Service\"\n"], [351, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [352, "    }\n"], [353, "\n"], [354, "    actions = [\n"], [355, "      \"s3:GetBucketAcl\",\n"], [356, "    ]\n"], [357, "\n"], [358, "    resources = [\n"], [359, "      aws_s3_bucket.this[0].arn,\n"], [360, "    ]\n"], [361, "\n"], [362, "  }\n"], [363, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [316, 363], "resource": "module.log_bucket.aws_iam_policy_document.lb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.AdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_lb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_49", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[316, "data \"aws_iam_policy_document\" \"lb_log_delivery\" {\n"], [317, "  count = local.create_bucket && var.attach_lb_log_delivery_policy ? 1 : 0\n"], [318, "\n"], [319, "  statement {\n"], [320, "    sid = \"AWSLogDeliveryWrite\"\n"], [321, "\n"], [322, "    principals {\n"], [323, "      type        = \"Service\"\n"], [324, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [325, "    }\n"], [326, "\n"], [327, "    effect = \"Allow\"\n"], [328, "\n"], [329, "    actions = [\n"], [330, "      \"s3:PutObject\",\n"], [331, "    ]\n"], [332, "\n"], [333, "    resources = [\n"], [334, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [335, "    ]\n"], [336, "\n"], [337, "    condition {\n"], [338, "      test     = \"StringEquals\"\n"], [339, "      variable = \"s3:x-amz-acl\"\n"], [340, "      values   = [\"bucket-owner-full-control\"]\n"], [341, "    }\n"], [342, "  }\n"], [343, "\n"], [344, "  statement {\n"], [345, "    sid = \"AWSLogDeliveryAclCheck\"\n"], [346, "\n"], [347, "    effect = \"Allow\"\n"], [348, "\n"], [349, "    principals {\n"], [350, "      type        = \"Service\"\n"], [351, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [352, "    }\n"], [353, "\n"], [354, "    actions = [\n"], [355, "      \"s3:GetBucketAcl\",\n"], [356, "    ]\n"], [357, "\n"], [358, "    resources = [\n"], [359, "      aws_s3_bucket.this[0].arn,\n"], [360, "    ]\n"], [361, "\n"], [362, "  }\n"], [363, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [316, 363], "resource": "module.log_bucket.aws_iam_policy_document.lb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.StarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_lb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_110", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[316, "data \"aws_iam_policy_document\" \"lb_log_delivery\" {\n"], [317, "  count = local.create_bucket && var.attach_lb_log_delivery_policy ? 1 : 0\n"], [318, "\n"], [319, "  statement {\n"], [320, "    sid = \"AWSLogDeliveryWrite\"\n"], [321, "\n"], [322, "    principals {\n"], [323, "      type        = \"Service\"\n"], [324, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [325, "    }\n"], [326, "\n"], [327, "    effect = \"Allow\"\n"], [328, "\n"], [329, "    actions = [\n"], [330, "      \"s3:PutObject\",\n"], [331, "    ]\n"], [332, "\n"], [333, "    resources = [\n"], [334, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [335, "    ]\n"], [336, "\n"], [337, "    condition {\n"], [338, "      test     = \"StringEquals\"\n"], [339, "      variable = \"s3:x-amz-acl\"\n"], [340, "      values   = [\"bucket-owner-full-control\"]\n"], [341, "    }\n"], [342, "  }\n"], [343, "\n"], [344, "  statement {\n"], [345, "    sid = \"AWSLogDeliveryAclCheck\"\n"], [346, "\n"], [347, "    effect = \"Allow\"\n"], [348, "\n"], [349, "    principals {\n"], [350, "      type        = \"Service\"\n"], [351, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [352, "    }\n"], [353, "\n"], [354, "    actions = [\n"], [355, "      \"s3:GetBucketAcl\",\n"], [356, "    ]\n"], [357, "\n"], [358, "    resources = [\n"], [359, "      aws_s3_bucket.this[0].arn,\n"], [360, "    ]\n"], [361, "\n"], [362, "  }\n"], [363, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [316, 363], "resource": "module.log_bucket.aws_iam_policy_document.lb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_lb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_111", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[316, "data \"aws_iam_policy_document\" \"lb_log_delivery\" {\n"], [317, "  count = local.create_bucket && var.attach_lb_log_delivery_policy ? 1 : 0\n"], [318, "\n"], [319, "  statement {\n"], [320, "    sid = \"AWSLogDeliveryWrite\"\n"], [321, "\n"], [322, "    principals {\n"], [323, "      type        = \"Service\"\n"], [324, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [325, "    }\n"], [326, "\n"], [327, "    effect = \"Allow\"\n"], [328, "\n"], [329, "    actions = [\n"], [330, "      \"s3:PutObject\",\n"], [331, "    ]\n"], [332, "\n"], [333, "    resources = [\n"], [334, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [335, "    ]\n"], [336, "\n"], [337, "    condition {\n"], [338, "      test     = \"StringEquals\"\n"], [339, "      variable = \"s3:x-amz-acl\"\n"], [340, "      values   = [\"bucket-owner-full-control\"]\n"], [341, "    }\n"], [342, "  }\n"], [343, "\n"], [344, "  statement {\n"], [345, "    sid = \"AWSLogDeliveryAclCheck\"\n"], [346, "\n"], [347, "    effect = \"Allow\"\n"], [348, "\n"], [349, "    principals {\n"], [350, "      type        = \"Service\"\n"], [351, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [352, "    }\n"], [353, "\n"], [354, "    actions = [\n"], [355, "      \"s3:GetBucketAcl\",\n"], [356, "    ]\n"], [357, "\n"], [358, "    resources = [\n"], [359, "      aws_s3_bucket.this[0].arn,\n"], [360, "    ]\n"], [361, "\n"], [362, "  }\n"], [363, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [316, 363], "resource": "module.log_bucket.aws_iam_policy_document.lb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_lb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_107", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[316, "data \"aws_iam_policy_document\" \"lb_log_delivery\" {\n"], [317, "  count = local.create_bucket && var.attach_lb_log_delivery_policy ? 1 : 0\n"], [318, "\n"], [319, "  statement {\n"], [320, "    sid = \"AWSLogDeliveryWrite\"\n"], [321, "\n"], [322, "    principals {\n"], [323, "      type        = \"Service\"\n"], [324, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [325, "    }\n"], [326, "\n"], [327, "    effect = \"Allow\"\n"], [328, "\n"], [329, "    actions = [\n"], [330, "      \"s3:PutObject\",\n"], [331, "    ]\n"], [332, "\n"], [333, "    resources = [\n"], [334, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [335, "    ]\n"], [336, "\n"], [337, "    condition {\n"], [338, "      test     = \"StringEquals\"\n"], [339, "      variable = \"s3:x-amz-acl\"\n"], [340, "      values   = [\"bucket-owner-full-control\"]\n"], [341, "    }\n"], [342, "  }\n"], [343, "\n"], [344, "  statement {\n"], [345, "    sid = \"AWSLogDeliveryAclCheck\"\n"], [346, "\n"], [347, "    effect = \"Allow\"\n"], [348, "\n"], [349, "    principals {\n"], [350, "      type        = \"Service\"\n"], [351, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [352, "    }\n"], [353, "\n"], [354, "    actions = [\n"], [355, "      \"s3:GetBucketAcl\",\n"], [356, "    ]\n"], [357, "\n"], [358, "    resources = [\n"], [359, "      aws_s3_bucket.this[0].arn,\n"], [360, "    ]\n"], [361, "\n"], [362, "  }\n"], [363, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [316, 363], "resource": "module.log_bucket.aws_iam_policy_document.lb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_lb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_108", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[316, "data \"aws_iam_policy_document\" \"lb_log_delivery\" {\n"], [317, "  count = local.create_bucket && var.attach_lb_log_delivery_policy ? 1 : 0\n"], [318, "\n"], [319, "  statement {\n"], [320, "    sid = \"AWSLogDeliveryWrite\"\n"], [321, "\n"], [322, "    principals {\n"], [323, "      type        = \"Service\"\n"], [324, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [325, "    }\n"], [326, "\n"], [327, "    effect = \"Allow\"\n"], [328, "\n"], [329, "    actions = [\n"], [330, "      \"s3:PutObject\",\n"], [331, "    ]\n"], [332, "\n"], [333, "    resources = [\n"], [334, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [335, "    ]\n"], [336, "\n"], [337, "    condition {\n"], [338, "      test     = \"StringEquals\"\n"], [339, "      variable = \"s3:x-amz-acl\"\n"], [340, "      values   = [\"bucket-owner-full-control\"]\n"], [341, "    }\n"], [342, "  }\n"], [343, "\n"], [344, "  statement {\n"], [345, "    sid = \"AWSLogDeliveryAclCheck\"\n"], [346, "\n"], [347, "    effect = \"Allow\"\n"], [348, "\n"], [349, "    principals {\n"], [350, "      type        = \"Service\"\n"], [351, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [352, "    }\n"], [353, "\n"], [354, "    actions = [\n"], [355, "      \"s3:GetBucketAcl\",\n"], [356, "    ]\n"], [357, "\n"], [358, "    resources = [\n"], [359, "      aws_s3_bucket.this[0].arn,\n"], [360, "    ]\n"], [361, "\n"], [362, "  }\n"], [363, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [316, 363], "resource": "module.log_bucket.aws_iam_policy_document.lb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_lb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_109", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[316, "data \"aws_iam_policy_document\" \"lb_log_delivery\" {\n"], [317, "  count = local.create_bucket && var.attach_lb_log_delivery_policy ? 1 : 0\n"], [318, "\n"], [319, "  statement {\n"], [320, "    sid = \"AWSLogDeliveryWrite\"\n"], [321, "\n"], [322, "    principals {\n"], [323, "      type        = \"Service\"\n"], [324, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [325, "    }\n"], [326, "\n"], [327, "    effect = \"Allow\"\n"], [328, "\n"], [329, "    actions = [\n"], [330, "      \"s3:PutObject\",\n"], [331, "    ]\n"], [332, "\n"], [333, "    resources = [\n"], [334, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [335, "    ]\n"], [336, "\n"], [337, "    condition {\n"], [338, "      test     = \"StringEquals\"\n"], [339, "      variable = \"s3:x-amz-acl\"\n"], [340, "      values   = [\"bucket-owner-full-control\"]\n"], [341, "    }\n"], [342, "  }\n"], [343, "\n"], [344, "  statement {\n"], [345, "    sid = \"AWSLogDeliveryAclCheck\"\n"], [346, "\n"], [347, "    effect = \"Allow\"\n"], [348, "\n"], [349, "    principals {\n"], [350, "      type        = \"Service\"\n"], [351, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [352, "    }\n"], [353, "\n"], [354, "    actions = [\n"], [355, "      \"s3:GetBucketAcl\",\n"], [356, "    ]\n"], [357, "\n"], [358, "    resources = [\n"], [359, "      aws_s3_bucket.this[0].arn,\n"], [360, "    ]\n"], [361, "\n"], [362, "  }\n"], [363, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [316, 363], "resource": "module.log_bucket.aws_iam_policy_document.lb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_lb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_283", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[316, "data \"aws_iam_policy_document\" \"lb_log_delivery\" {\n"], [317, "  count = local.create_bucket && var.attach_lb_log_delivery_policy ? 1 : 0\n"], [318, "\n"], [319, "  statement {\n"], [320, "    sid = \"AWSLogDeliveryWrite\"\n"], [321, "\n"], [322, "    principals {\n"], [323, "      type        = \"Service\"\n"], [324, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [325, "    }\n"], [326, "\n"], [327, "    effect = \"Allow\"\n"], [328, "\n"], [329, "    actions = [\n"], [330, "      \"s3:PutObject\",\n"], [331, "    ]\n"], [332, "\n"], [333, "    resources = [\n"], [334, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [335, "    ]\n"], [336, "\n"], [337, "    condition {\n"], [338, "      test     = \"StringEquals\"\n"], [339, "      variable = \"s3:x-amz-acl\"\n"], [340, "      values   = [\"bucket-owner-full-control\"]\n"], [341, "    }\n"], [342, "  }\n"], [343, "\n"], [344, "  statement {\n"], [345, "    sid = \"AWSLogDeliveryAclCheck\"\n"], [346, "\n"], [347, "    effect = \"Allow\"\n"], [348, "\n"], [349, "    principals {\n"], [350, "      type        = \"Service\"\n"], [351, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [352, "    }\n"], [353, "\n"], [354, "    actions = [\n"], [355, "      \"s3:GetBucketAcl\",\n"], [356, "    ]\n"], [357, "\n"], [358, "    resources = [\n"], [359, "      aws_s3_bucket.this[0].arn,\n"], [360, "    ]\n"], [361, "\n"], [362, "  }\n"], [363, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [316, 363], "resource": "module.log_bucket.aws_iam_policy_document.lb_log_delivery", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPublichActionsPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_lb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_1", "bc_check_id": null, "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.log_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.AdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_49", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.log_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.StarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_110", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.log_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_111", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.log_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_107", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.log_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_108", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.log_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_109", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.log_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_283", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.log_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPublichActionsPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_1", "bc_check_id": null, "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.log_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.AdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_49", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.log_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.StarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_110", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.log_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_111", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.log_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_107", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.log_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_108", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.log_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_109", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.log_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_283", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.log_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPublichActionsPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_70", "bc_check_id": null, "check_name": "Ensure S3 bucket does not allow an action with any Principal", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AllowsAnyPrincipal", "fixed_definition": null, "entity_tags": {}, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": null, "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {}, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_70", "bc_check_id": null, "check_name": "Ensure S3 bucket does not allow an action with any Principal", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[267, "resource \"aws_s3_bucket_policy\" \"this\" {\n"], [268, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [269, "\n"], [270, "  bucket = aws_s3_bucket.this[0].id\n"], [271, "  policy = data.aws_iam_policy_document.combined[0].json\n"], [272, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [267, 272], "resource": "module.log_bucket.aws_s3_bucket_policy.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AllowsAnyPrincipal", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": null, "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[267, "resource \"aws_s3_bucket_policy\" \"this\" {\n"], [268, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [269, "\n"], [270, "  bucket = aws_s3_bucket.this[0].id\n"], [271, "  policy = data.aws_iam_policy_document.combined[0].json\n"], [272, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [267, 272], "resource": "module.log_bucket.aws_s3_bucket_policy.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_1", "bc_check_id": null, "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.cloudfront_log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.AdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_49", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.cloudfront_log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.StarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_110", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.cloudfront_log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_111", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.cloudfront_log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_107", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.cloudfront_log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_108", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.cloudfront_log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_109", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.cloudfront_log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_283", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.cloudfront_log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPublichActionsPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_70", "bc_check_id": null, "check_name": "Ensure S3 bucket does not allow an action with any Principal", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.cloudfront_log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AllowsAnyPrincipal", "fixed_definition": null, "entity_tags": {}, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": null, "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.cloudfront_log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {}, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_70", "bc_check_id": null, "check_name": "Ensure S3 bucket does not allow an action with any Principal", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[267, "resource \"aws_s3_bucket_policy\" \"this\" {\n"], [268, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [269, "\n"], [270, "  bucket = aws_s3_bucket.this[0].id\n"], [271, "  policy = data.aws_iam_policy_document.combined[0].json\n"], [272, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [267, 272], "resource": "module.cloudfront_log_bucket.aws_s3_bucket_policy.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AllowsAnyPrincipal", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": null, "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[267, "resource \"aws_s3_bucket_policy\" \"this\" {\n"], [268, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [269, "\n"], [270, "  bucket = aws_s3_bucket.this[0].id\n"], [271, "  policy = data.aws_iam_policy_document.combined[0].json\n"], [272, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [267, 272], "resource": "module.cloudfront_log_bucket.aws_s3_bucket_policy.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_1", "bc_check_id": null, "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.s3_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.AdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_49", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.s3_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.StarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_110", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.s3_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_111", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.s3_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_107", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.s3_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_108", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.s3_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_109", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.s3_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_283", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.s3_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPublichActionsPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_1", "bc_check_id": null, "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.s3_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.AdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_49", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.s3_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.StarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_110", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.s3_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_111", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.s3_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_107", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.s3_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_108", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.s3_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_109", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.s3_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_283", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.s3_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPublichActionsPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_1", "bc_check_id": null, "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.s3_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.AdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_49", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.s3_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.StarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_110", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.s3_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_111", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.s3_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_107", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.s3_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_108", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.s3_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_109", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.s3_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_283", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.s3_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPublichActionsPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_70", "bc_check_id": null, "check_name": "Ensure S3 bucket does not allow an action with any Principal", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.s3_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AllowsAnyPrincipal", "fixed_definition": null, "entity_tags": {"Owner": "Anton"}, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": null, "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.s3_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Owner": "Anton"}, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_70", "bc_check_id": null, "check_name": "Ensure S3 bucket does not allow an action with any Principal", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[267, "resource \"aws_s3_bucket_policy\" \"this\" {\n"], [268, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [269, "\n"], [270, "  bucket = aws_s3_bucket.this[0].id\n"], [271, "  policy = data.aws_iam_policy_document.combined[0].json\n"], [272, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [267, 272], "resource": "module.s3_bucket.aws_s3_bucket_policy.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AllowsAnyPrincipal", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": null, "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[267, "resource \"aws_s3_bucket_policy\" \"this\" {\n"], [268, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [269, "\n"], [270, "  bucket = aws_s3_bucket.this[0].id\n"], [271, "  policy = data.aws_iam_policy_document.combined[0].json\n"], [272, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [267, 272], "resource": "module.s3_bucket.aws_s3_bucket_policy.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_55", "bc_check_id": null, "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[427, "resource \"aws_s3_bucket_public_access_block\" \"this\" {\n"], [428, "  count = local.create_bucket && var.attach_public_policy ? 1 : 0\n"], [429, "\n"], [430, "  # Chain resources (s3_bucket -> s3_bucket_policy -> s3_bucket_public_access_block)\n"], [431, "  # to prevent \"A conflicting conditional operation is currently in progress against this resource.\"\n"], [432, "  # Ref: https://github.com/hashicorp/terraform-provider-aws/issues/7628\n"], [433, "\n"], [434, "  bucket = local.attach_policy ? aws_s3_bucket_policy.this[0].id : aws_s3_bucket.this[0].id\n"], [435, "\n"], [436, "  block_public_acls       = var.block_public_acls\n"], [437, "  block_public_policy     = var.block_public_policy\n"], [438, "  ignore_public_acls      = var.ignore_public_acls\n"], [439, "  restrict_public_buckets = var.restrict_public_buckets\n"], [440, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [427, 440], "resource": "module.s3_bucket.aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_policy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "ignore_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "ignore_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "restrict_public_buckets": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "restrict_public_buckets", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "resource", "name": "aws_s3_bucket.this", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_56", "bc_check_id": null, "check_name": "Ensure S3 bucket has 'restrict_public_bucket' enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[427, "resource \"aws_s3_bucket_public_access_block\" \"this\" {\n"], [428, "  count = local.create_bucket && var.attach_public_policy ? 1 : 0\n"], [429, "\n"], [430, "  # Chain resources (s3_bucket -> s3_bucket_policy -> s3_bucket_public_access_block)\n"], [431, "  # to prevent \"A conflicting conditional operation is currently in progress against this resource.\"\n"], [432, "  # Ref: https://github.com/hashicorp/terraform-provider-aws/issues/7628\n"], [433, "\n"], [434, "  bucket = local.attach_policy ? aws_s3_bucket_policy.this[0].id : aws_s3_bucket.this[0].id\n"], [435, "\n"], [436, "  block_public_acls       = var.block_public_acls\n"], [437, "  block_public_policy     = var.block_public_policy\n"], [438, "  ignore_public_acls      = var.ignore_public_acls\n"], [439, "  restrict_public_buckets = var.restrict_public_buckets\n"], [440, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [427, 440], "resource": "module.s3_bucket.aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_policy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "ignore_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "ignore_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "restrict_public_buckets": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "restrict_public_buckets", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "resource", "name": "aws_s3_bucket.this", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_53", "bc_check_id": null, "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[427, "resource \"aws_s3_bucket_public_access_block\" \"this\" {\n"], [428, "  count = local.create_bucket && var.attach_public_policy ? 1 : 0\n"], [429, "\n"], [430, "  # Chain resources (s3_bucket -> s3_bucket_policy -> s3_bucket_public_access_block)\n"], [431, "  # to prevent \"A conflicting conditional operation is currently in progress against this resource.\"\n"], [432, "  # Ref: https://github.com/hashicorp/terraform-provider-aws/issues/7628\n"], [433, "\n"], [434, "  bucket = local.attach_policy ? aws_s3_bucket_policy.this[0].id : aws_s3_bucket.this[0].id\n"], [435, "\n"], [436, "  block_public_acls       = var.block_public_acls\n"], [437, "  block_public_policy     = var.block_public_policy\n"], [438, "  ignore_public_acls      = var.ignore_public_acls\n"], [439, "  restrict_public_buckets = var.restrict_public_buckets\n"], [440, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [427, 440], "resource": "module.s3_bucket.aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_policy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "ignore_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "ignore_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "restrict_public_buckets": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "restrict_public_buckets", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "resource", "name": "aws_s3_bucket.this", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_54", "bc_check_id": null, "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[427, "resource \"aws_s3_bucket_public_access_block\" \"this\" {\n"], [428, "  count = local.create_bucket && var.attach_public_policy ? 1 : 0\n"], [429, "\n"], [430, "  # Chain resources (s3_bucket -> s3_bucket_policy -> s3_bucket_public_access_block)\n"], [431, "  # to prevent \"A conflicting conditional operation is currently in progress against this resource.\"\n"], [432, "  # Ref: https://github.com/hashicorp/terraform-provider-aws/issues/7628\n"], [433, "\n"], [434, "  bucket = local.attach_policy ? aws_s3_bucket_policy.this[0].id : aws_s3_bucket.this[0].id\n"], [435, "\n"], [436, "  block_public_acls       = var.block_public_acls\n"], [437, "  block_public_policy     = var.block_public_policy\n"], [438, "  ignore_public_acls      = var.ignore_public_acls\n"], [439, "  restrict_public_buckets = var.restrict_public_buckets\n"], [440, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [427, 440], "resource": "module.s3_bucket.aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_policy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "ignore_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "ignore_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "restrict_public_buckets": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "restrict_public_buckets", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "resource", "name": "aws_s3_bucket.this", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_57", "bc_check_id": null, "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["private"], "bucket": ["s3-bucket-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{"Owner": "Anton"}], "__address__": "module.s3_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["access_control_policy/grant/*/permission", "acl", "access_control_policy", "access_control_policy/grant", "resource_type", "access_control_policy/grant/*/grantee/uri"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.s3_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Owner": "Anton"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_57", "bc_check_id": null, "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["log-delivery-write"], "bucket": ["logs-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{}], "__address__": "module.log_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["access_control_policy/grant/*/permission", "acl", "access_control_policy", "access_control_policy/grant", "resource_type", "access_control_policy/grant/*/grantee/uri"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_20", "bc_check_id": null, "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["private"], "bucket": ["s3-bucket-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{"Owner": "Anton"}], "__address__": "module.s3_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["acl", "access_control_policy", "access_control_policy/grant", "resource_type", "access_control_policy/grant/*/grantee/uri"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.s3_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Owner": "Anton"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_20", "bc_check_id": null, "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["log-delivery-write"], "bucket": ["logs-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{}], "__address__": "module.log_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["acl", "access_control_policy", "access_control_policy/grant", "resource_type", "access_control_policy/grant/*/grantee/uri"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": null, "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"this": {"__end_line__": 46, "__start_line__": 30, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Principal": {"Service": "ec2.amazonaws.com"}, "Effect": "Allow", "Sid": ""}]}], "__address__": "aws_iam_role.this"}}}, "evaluated_keys": ["managed_policy_arn", "policy_arn", "arn", "name", "managed_policy_arns/*"]}, "code_block": [[30, "resource \"aws_iam_role\" \"this\" {\n"], [31, "  assume_role_policy = <<EOF\n"], [32, "{\n"], [33, "  \"Version\": \"2012-10-17\",\n"], [34, "  \"Statement\": [\n"], [35, "    {\n"], [36, "      \"Action\": \"sts:AssumeRole\",\n"], [37, "      \"Principal\": {\n"], [38, "        \"Service\": \"ec2.amazonaws.com\"\n"], [39, "      },\n"], [40, "      \"Effect\": \"Allow\",\n"], [41, "      \"Sid\": \"\"\n"], [42, "    }\n"], [43, "  ]\n"], [44, "}\n"], [45, "EOF\n"], [46, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [30, 46], "resource": "aws_iam_role.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": null, "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["private"], "bucket": ["s3-bucket-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{"Owner": "Anton"}], "__address__": "module.s3_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.s3_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Owner": "Anton"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_18", "bc_check_id": null, "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["log-delivery-write"], "bucket": ["logs-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{}], "__address__": "module.log_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_18", "bc_check_id": null, "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["var.acl"], "bucket": ["cloudfront-logs-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{}], "__address__": "module.cloudfront_log_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.cloudfront_log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"bucket_policy": {"__end_line__": 63, "__start_line__": 48, "statement": [{"actions": [["s3:ListBucket"]], "principals": [{"identifiers": [["aws_iam_role.this.arn"]], "type": ["AWS"]}], "resources": [["arn:aws:s3:::s3-bucket-${random_pet.this.id}"]]}], "__address__": "aws_iam_policy_document.bucket_policy"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[48, "data \"aws_iam_policy_document\" \"bucket_policy\" {\n"], [49, "  statement {\n"], [50, "    principals {\n"], [51, "      type        = \"AWS\"\n"], [52, "      identifiers = [aws_iam_role.this.arn]\n"], [53, "    }\n"], [54, "\n"], [55, "    actions = [\n"], [56, "      \"s3:ListBucket\",\n"], [57, "    ]\n"], [58, "\n"], [59, "    resources = [\n"], [60, "      \"arn:aws:s3:::${local.bucket_name}\",\n"], [61, "    ]\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [48, 63], "resource": "aws_iam_policy_document.bucket_policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "breadcrumbs": {"statement.resources.0": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}], "statement.resources": [{"type": "locals", "name": "bucket_name", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"combined": {"__end_line__": 284, "__start_line__": 274, "count": [1], "source_policy_documents": ["var.policy"], "__address__": "module.log_bucket.aws_iam_policy_document.combined"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"combined": {"__end_line__": 284, "__start_line__": 274, "count": [1], "source_policy_documents": ["var.policy"], "__address__": "module.cloudfront_log_bucket.aws_iam_policy_document.combined"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.cloudfront_log_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"combined": {"__end_line__": 284, "__start_line__": 274, "count": [1], "source_policy_documents": ["data.aws_iam_policy_document.bucket_policy.json"], "__address__": "module.s3_bucket.aws_iam_policy_document.combined"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[274, "data \"aws_iam_policy_document\" \"combined\" {\n"], [275, "  count = local.create_bucket && local.attach_policy ? 1 : 0\n"], [276, "\n"], [277, "  source_policy_documents = compact([\n"], [278, "    var.attach_elb_log_delivery_policy ? data.aws_iam_policy_document.elb_log_delivery[0].json : \"\",\n"], [279, "    var.attach_lb_log_delivery_policy ? data.aws_iam_policy_document.lb_log_delivery[0].json : \"\",\n"], [280, "    var.attach_require_latest_tls_policy ? data.aws_iam_policy_document.require_latest_tls[0].json : \"\",\n"], [281, "    var.attach_deny_insecure_transport_policy ? data.aws_iam_policy_document.deny_insecure_transport[0].json : \"\",\n"], [282, "    var.attach_policy ? var.policy : \"\"\n"], [283, "  ])\n"], [284, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [274, 284], "resource": "module.s3_bucket.aws_iam_policy_document.combined", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"source_policy_documents": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "attach_require_latest_tls_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"elb_log_delivery": {"__end_line__": 312, "__start_line__": 291, "count": [1], "statement": [{"actions": [["s3:PutObject"]], "effect": ["Allow"], "principals": [{"identifiers": ["data.aws_elb_service_account.this.*.arn"], "type": ["AWS"]}], "resources": [["${aws_s3_bucket.this[0].arn}/*"]], "sid": [""]}], "__address__": "module.log_bucket.aws_iam_policy_document.elb_log_delivery"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[291, "data \"aws_iam_policy_document\" \"elb_log_delivery\" {\n"], [292, "  count = local.create_bucket && var.attach_elb_log_delivery_policy ? 1 : 0\n"], [293, "\n"], [294, "  statement {\n"], [295, "    sid = \"\"\n"], [296, "\n"], [297, "    principals {\n"], [298, "      type        = \"AWS\"\n"], [299, "      identifiers = data.aws_elb_service_account.this.*.arn\n"], [300, "    }\n"], [301, "\n"], [302, "    effect = \"Allow\"\n"], [303, "\n"], [304, "    actions = [\n"], [305, "      \"s3:PutObject\",\n"], [306, "    ]\n"], [307, "\n"], [308, "    resources = [\n"], [309, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [310, "    ]\n"], [311, "  }\n"], [312, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [291, 312], "resource": "module.log_bucket.aws_iam_policy_document.elb_log_delivery", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_elb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"elb_log_delivery": {"__end_line__": 312, "__start_line__": 291, "count": [0], "statement": [{"actions": [["s3:PutObject"]], "effect": ["Allow"], "principals": [{"identifiers": ["data.aws_elb_service_account.this.*.arn"], "type": ["AWS"]}], "resources": [["${aws_s3_bucket.this[0].arn}/*"]], "sid": [""]}], "__address__": "module.cloudfront_log_bucket.aws_iam_policy_document.elb_log_delivery"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[291, "data \"aws_iam_policy_document\" \"elb_log_delivery\" {\n"], [292, "  count = local.create_bucket && var.attach_elb_log_delivery_policy ? 1 : 0\n"], [293, "\n"], [294, "  statement {\n"], [295, "    sid = \"\"\n"], [296, "\n"], [297, "    principals {\n"], [298, "      type        = \"AWS\"\n"], [299, "      identifiers = data.aws_elb_service_account.this.*.arn\n"], [300, "    }\n"], [301, "\n"], [302, "    effect = \"Allow\"\n"], [303, "\n"], [304, "    actions = [\n"], [305, "      \"s3:PutObject\",\n"], [306, "    ]\n"], [307, "\n"], [308, "    resources = [\n"], [309, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [310, "    ]\n"], [311, "  }\n"], [312, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [291, 312], "resource": "module.cloudfront_log_bucket.aws_iam_policy_document.elb_log_delivery", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_elb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"elb_log_delivery": {"__end_line__": 312, "__start_line__": 291, "count": [0], "statement": [{"actions": [["s3:PutObject"]], "effect": ["Allow"], "principals": [{"identifiers": ["data.aws_elb_service_account.this.*.arn"], "type": ["AWS"]}], "resources": [["${aws_s3_bucket.this[0].arn}/*"]], "sid": [""]}], "__address__": "module.s3_bucket.aws_iam_policy_document.elb_log_delivery"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[291, "data \"aws_iam_policy_document\" \"elb_log_delivery\" {\n"], [292, "  count = local.create_bucket && var.attach_elb_log_delivery_policy ? 1 : 0\n"], [293, "\n"], [294, "  statement {\n"], [295, "    sid = \"\"\n"], [296, "\n"], [297, "    principals {\n"], [298, "      type        = \"AWS\"\n"], [299, "      identifiers = data.aws_elb_service_account.this.*.arn\n"], [300, "    }\n"], [301, "\n"], [302, "    effect = \"Allow\"\n"], [303, "\n"], [304, "    actions = [\n"], [305, "      \"s3:PutObject\",\n"], [306, "    ]\n"], [307, "\n"], [308, "    resources = [\n"], [309, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [310, "    ]\n"], [311, "  }\n"], [312, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [291, 312], "resource": "module.s3_bucket.aws_iam_policy_document.elb_log_delivery", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_elb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"lb_log_delivery": {"__end_line__": 363, "__start_line__": 316, "count": [1], "statement": [{"actions": [["s3:PutObject"]], "condition": [{"test": ["StringEquals"], "values": [["bucket-owner-full-control"]], "variable": ["s3:x-amz-acl"]}], "effect": ["Allow"], "principals": [{"identifiers": [["delivery.logs.amazonaws.com"]], "type": ["Service"]}], "resources": [["${aws_s3_bucket.this[0].arn}/*"]], "sid": ["AWSLogDeliveryWrite"]}, {"actions": [["s3:GetBucketAcl"]], "effect": ["Allow"], "principals": [{"identifiers": [["delivery.logs.amazonaws.com"]], "type": ["Service"]}], "resources": [["${aws_s3_bucket.this[0].arn}"]], "sid": ["AWSLogDeliveryAclCheck"]}], "__address__": "module.log_bucket.aws_iam_policy_document.lb_log_delivery"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[316, "data \"aws_iam_policy_document\" \"lb_log_delivery\" {\n"], [317, "  count = local.create_bucket && var.attach_lb_log_delivery_policy ? 1 : 0\n"], [318, "\n"], [319, "  statement {\n"], [320, "    sid = \"AWSLogDeliveryWrite\"\n"], [321, "\n"], [322, "    principals {\n"], [323, "      type        = \"Service\"\n"], [324, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [325, "    }\n"], [326, "\n"], [327, "    effect = \"Allow\"\n"], [328, "\n"], [329, "    actions = [\n"], [330, "      \"s3:PutObject\",\n"], [331, "    ]\n"], [332, "\n"], [333, "    resources = [\n"], [334, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [335, "    ]\n"], [336, "\n"], [337, "    condition {\n"], [338, "      test     = \"StringEquals\"\n"], [339, "      variable = \"s3:x-amz-acl\"\n"], [340, "      values   = [\"bucket-owner-full-control\"]\n"], [341, "    }\n"], [342, "  }\n"], [343, "\n"], [344, "  statement {\n"], [345, "    sid = \"AWSLogDeliveryAclCheck\"\n"], [346, "\n"], [347, "    effect = \"Allow\"\n"], [348, "\n"], [349, "    principals {\n"], [350, "      type        = \"Service\"\n"], [351, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [352, "    }\n"], [353, "\n"], [354, "    actions = [\n"], [355, "      \"s3:GetBucketAcl\",\n"], [356, "    ]\n"], [357, "\n"], [358, "    resources = [\n"], [359, "      aws_s3_bucket.this[0].arn,\n"], [360, "    ]\n"], [361, "\n"], [362, "  }\n"], [363, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [316, 363], "resource": "module.log_bucket.aws_iam_policy_document.lb_log_delivery", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_lb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"lb_log_delivery": {"__end_line__": 363, "__start_line__": 316, "count": [0], "statement": [{"actions": [["s3:PutObject"]], "condition": [{"test": ["StringEquals"], "values": [["bucket-owner-full-control"]], "variable": ["s3:x-amz-acl"]}], "effect": ["Allow"], "principals": [{"identifiers": [["delivery.logs.amazonaws.com"]], "type": ["Service"]}], "resources": [["${aws_s3_bucket.this[0].arn}/*"]], "sid": ["AWSLogDeliveryWrite"]}, {"actions": [["s3:GetBucketAcl"]], "effect": ["Allow"], "principals": [{"identifiers": [["delivery.logs.amazonaws.com"]], "type": ["Service"]}], "resources": [["${aws_s3_bucket.this[0].arn}"]], "sid": ["AWSLogDeliveryAclCheck"]}], "__address__": "module.cloudfront_log_bucket.aws_iam_policy_document.lb_log_delivery"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[316, "data \"aws_iam_policy_document\" \"lb_log_delivery\" {\n"], [317, "  count = local.create_bucket && var.attach_lb_log_delivery_policy ? 1 : 0\n"], [318, "\n"], [319, "  statement {\n"], [320, "    sid = \"AWSLogDeliveryWrite\"\n"], [321, "\n"], [322, "    principals {\n"], [323, "      type        = \"Service\"\n"], [324, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [325, "    }\n"], [326, "\n"], [327, "    effect = \"Allow\"\n"], [328, "\n"], [329, "    actions = [\n"], [330, "      \"s3:PutObject\",\n"], [331, "    ]\n"], [332, "\n"], [333, "    resources = [\n"], [334, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [335, "    ]\n"], [336, "\n"], [337, "    condition {\n"], [338, "      test     = \"StringEquals\"\n"], [339, "      variable = \"s3:x-amz-acl\"\n"], [340, "      values   = [\"bucket-owner-full-control\"]\n"], [341, "    }\n"], [342, "  }\n"], [343, "\n"], [344, "  statement {\n"], [345, "    sid = \"AWSLogDeliveryAclCheck\"\n"], [346, "\n"], [347, "    effect = \"Allow\"\n"], [348, "\n"], [349, "    principals {\n"], [350, "      type        = \"Service\"\n"], [351, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [352, "    }\n"], [353, "\n"], [354, "    actions = [\n"], [355, "      \"s3:GetBucketAcl\",\n"], [356, "    ]\n"], [357, "\n"], [358, "    resources = [\n"], [359, "      aws_s3_bucket.this[0].arn,\n"], [360, "    ]\n"], [361, "\n"], [362, "  }\n"], [363, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [316, 363], "resource": "module.cloudfront_log_bucket.aws_iam_policy_document.lb_log_delivery", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_lb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"lb_log_delivery": {"__end_line__": 363, "__start_line__": 316, "count": [0], "statement": [{"actions": [["s3:PutObject"]], "condition": [{"test": ["StringEquals"], "values": [["bucket-owner-full-control"]], "variable": ["s3:x-amz-acl"]}], "effect": ["Allow"], "principals": [{"identifiers": [["delivery.logs.amazonaws.com"]], "type": ["Service"]}], "resources": [["${aws_s3_bucket.this[0].arn}/*"]], "sid": ["AWSLogDeliveryWrite"]}, {"actions": [["s3:GetBucketAcl"]], "effect": ["Allow"], "principals": [{"identifiers": [["delivery.logs.amazonaws.com"]], "type": ["Service"]}], "resources": [["${aws_s3_bucket.this[0].arn}"]], "sid": ["AWSLogDeliveryAclCheck"]}], "__address__": "module.s3_bucket.aws_iam_policy_document.lb_log_delivery"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[316, "data \"aws_iam_policy_document\" \"lb_log_delivery\" {\n"], [317, "  count = local.create_bucket && var.attach_lb_log_delivery_policy ? 1 : 0\n"], [318, "\n"], [319, "  statement {\n"], [320, "    sid = \"AWSLogDeliveryWrite\"\n"], [321, "\n"], [322, "    principals {\n"], [323, "      type        = \"Service\"\n"], [324, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [325, "    }\n"], [326, "\n"], [327, "    effect = \"Allow\"\n"], [328, "\n"], [329, "    actions = [\n"], [330, "      \"s3:PutObject\",\n"], [331, "    ]\n"], [332, "\n"], [333, "    resources = [\n"], [334, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [335, "    ]\n"], [336, "\n"], [337, "    condition {\n"], [338, "      test     = \"StringEquals\"\n"], [339, "      variable = \"s3:x-amz-acl\"\n"], [340, "      values   = [\"bucket-owner-full-control\"]\n"], [341, "    }\n"], [342, "  }\n"], [343, "\n"], [344, "  statement {\n"], [345, "    sid = \"AWSLogDeliveryAclCheck\"\n"], [346, "\n"], [347, "    effect = \"Allow\"\n"], [348, "\n"], [349, "    principals {\n"], [350, "      type        = \"Service\"\n"], [351, "      identifiers = [\"delivery.logs.amazonaws.com\"]\n"], [352, "    }\n"], [353, "\n"], [354, "    actions = [\n"], [355, "      \"s3:GetBucketAcl\",\n"], [356, "    ]\n"], [357, "\n"], [358, "    resources = [\n"], [359, "      aws_s3_bucket.this[0].arn,\n"], [360, "    ]\n"], [361, "\n"], [362, "  }\n"], [363, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [316, 363], "resource": "module.s3_bucket.aws_iam_policy_document.lb_log_delivery", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_lb_log_delivery_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"deny_insecure_transport": {"__end_line__": 394, "__start_line__": 365, "count": [1], "statement": [{"actions": [["s3:*"]], "condition": [{"test": ["Bool"], "values": [[false]], "variable": ["aws:SecureTransport"]}], "effect": ["Deny"], "principals": [{"identifiers": [["*"]], "type": ["*"]}], "resources": [["aws_s3_bucket.this[0].arn", "${aws_s3_bucket.this[0].arn}/*"]], "sid": ["denyInsecureTransport"]}], "__address__": "module.log_bucket.aws_iam_policy_document.deny_insecure_transport"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.log_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"deny_insecure_transport": {"__end_line__": 394, "__start_line__": 365, "count": [0], "statement": [{"actions": [["s3:*"]], "condition": [{"test": ["Bool"], "values": [[false]], "variable": ["aws:SecureTransport"]}], "effect": ["Deny"], "principals": [{"identifiers": [["*"]], "type": ["*"]}], "resources": [["aws_s3_bucket.this[0].arn", "${aws_s3_bucket.this[0].arn}/*"]], "sid": ["denyInsecureTransport"]}], "__address__": "module.cloudfront_log_bucket.aws_iam_policy_document.deny_insecure_transport"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.cloudfront_log_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"deny_insecure_transport": {"__end_line__": 394, "__start_line__": 365, "count": [1], "statement": [{"actions": [["s3:*"]], "condition": [{"test": ["Bool"], "values": [[false]], "variable": ["aws:SecureTransport"]}], "effect": ["Deny"], "principals": [{"identifiers": [["*"]], "type": ["*"]}], "resources": [["aws_s3_bucket.this[0].arn", "${aws_s3_bucket.this[0].arn}/*"]], "sid": ["denyInsecureTransport"]}], "__address__": "module.s3_bucket.aws_iam_policy_document.deny_insecure_transport"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[365, "data \"aws_iam_policy_document\" \"deny_insecure_transport\" {\n"], [366, "  count = local.create_bucket && var.attach_deny_insecure_transport_policy ? 1 : 0\n"], [367, "\n"], [368, "  statement {\n"], [369, "    sid    = \"denyInsecureTransport\"\n"], [370, "    effect = \"Deny\"\n"], [371, "\n"], [372, "    actions = [\n"], [373, "      \"s3:*\",\n"], [374, "    ]\n"], [375, "\n"], [376, "    resources = [\n"], [377, "      aws_s3_bucket.this[0].arn,\n"], [378, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [379, "    ]\n"], [380, "\n"], [381, "    principals {\n"], [382, "      type        = \"*\"\n"], [383, "      identifiers = [\"*\"]\n"], [384, "    }\n"], [385, "\n"], [386, "    condition {\n"], [387, "      test     = \"Bool\"\n"], [388, "      variable = \"aws:SecureTransport\"\n"], [389, "      values = [\n"], [390, "        \"false\"\n"], [391, "      ]\n"], [392, "    }\n"], [393, "  }\n"], [394, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [365, 394], "resource": "module.s3_bucket.aws_iam_policy_document.deny_insecure_transport", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"require_latest_tls": {"__end_line__": 425, "__start_line__": 396, "count": [1], "statement": [{"actions": [["s3:*"]], "condition": [{"test": ["NumericLessThan"], "values": [["1.2"]], "variable": ["s3:TlsVersion"]}], "effect": ["Deny"], "principals": [{"identifiers": [["*"]], "type": ["*"]}], "resources": [["aws_s3_bucket.this[0].arn", "${aws_s3_bucket.this[0].arn}/*"]], "sid": ["denyOutdatedTLS"]}], "__address__": "module.log_bucket.aws_iam_policy_document.require_latest_tls"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.log_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"require_latest_tls": {"__end_line__": 425, "__start_line__": 396, "count": [0], "statement": [{"actions": [["s3:*"]], "condition": [{"test": ["NumericLessThan"], "values": [["1.2"]], "variable": ["s3:TlsVersion"]}], "effect": ["Deny"], "principals": [{"identifiers": [["*"]], "type": ["*"]}], "resources": [["aws_s3_bucket.this[0].arn", "${aws_s3_bucket.this[0].arn}/*"]], "sid": ["denyOutdatedTLS"]}], "__address__": "module.cloudfront_log_bucket.aws_iam_policy_document.require_latest_tls"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.cloudfront_log_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"require_latest_tls": {"__end_line__": 425, "__start_line__": 396, "count": [1], "statement": [{"actions": [["s3:*"]], "condition": [{"test": ["NumericLessThan"], "values": [["1.2"]], "variable": ["s3:TlsVersion"]}], "effect": ["Deny"], "principals": [{"identifiers": [["*"]], "type": ["*"]}], "resources": [["aws_s3_bucket.this[0].arn", "${aws_s3_bucket.this[0].arn}/*"]], "sid": ["denyOutdatedTLS"]}], "__address__": "module.s3_bucket.aws_iam_policy_document.require_latest_tls"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[396, "data \"aws_iam_policy_document\" \"require_latest_tls\" {\n"], [397, "  count = local.create_bucket && var.attach_require_latest_tls_policy ? 1 : 0\n"], [398, "\n"], [399, "  statement {\n"], [400, "    sid    = \"denyOutdatedTLS\"\n"], [401, "    effect = \"Deny\"\n"], [402, "\n"], [403, "    actions = [\n"], [404, "      \"s3:*\",\n"], [405, "    ]\n"], [406, "\n"], [407, "    resources = [\n"], [408, "      aws_s3_bucket.this[0].arn,\n"], [409, "      \"${aws_s3_bucket.this[0].arn}/*\",\n"], [410, "    ]\n"], [411, "\n"], [412, "    principals {\n"], [413, "      type        = \"*\"\n"], [414, "      identifiers = [\"*\"]\n"], [415, "    }\n"], [416, "\n"], [417, "    condition {\n"], [418, "      test     = \"NumericLessThan\"\n"], [419, "      variable = \"s3:TlsVersion\"\n"], [420, "      values = [\n"], [421, "        \"1.2\"\n"], [422, "      ]\n"], [423, "    }\n"], [424, "  }\n"], [425, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [396, 425], "resource": "module.s3_bucket.aws_iam_policy_document.require_latest_tls", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}], "failed_checks": [{"check_id": "CKV_AWS_7", "bc_check_id": null, "check_name": "Ensure rotation for customer created CMKs is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enable_key_rotation"]}, "code_block": [[25, "resource \"aws_kms_key\" \"objects\" {\n"], [26, "  description             = \"KMS key is used to encrypt bucket objects\"\n"], [27, "  deletion_window_in_days = 7\n"], [28, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "repo_file_path": "/main.tf", "file_line_range": [25, 28], "resource": "aws_kms_key.objects", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSRotation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf"}, {"check_id": "CKV_AWS_143", "bc_check_id": null, "check_name": "Ensure that S3 bucket has lock configuration enabled by default", "check_result": {"result": "FAILED", "evaluated_keys": ["object_lock_configuration/[0]/object_lock_enabled"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BucketObjectLock", "fixed_definition": null, "entity_tags": {}, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_55", "bc_check_id": null, "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[427, "resource \"aws_s3_bucket_public_access_block\" \"this\" {\n"], [428, "  count = local.create_bucket && var.attach_public_policy ? 1 : 0\n"], [429, "\n"], [430, "  # Chain resources (s3_bucket -> s3_bucket_policy -> s3_bucket_public_access_block)\n"], [431, "  # to prevent \"A conflicting conditional operation is currently in progress against this resource.\"\n"], [432, "  # Ref: https://github.com/hashicorp/terraform-provider-aws/issues/7628\n"], [433, "\n"], [434, "  bucket = local.attach_policy ? aws_s3_bucket_policy.this[0].id : aws_s3_bucket.this[0].id\n"], [435, "\n"], [436, "  block_public_acls       = var.block_public_acls\n"], [437, "  block_public_policy     = var.block_public_policy\n"], [438, "  ignore_public_acls      = var.ignore_public_acls\n"], [439, "  restrict_public_buckets = var.restrict_public_buckets\n"], [440, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [427, 440], "resource": "module.log_bucket.aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_policy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "ignore_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "ignore_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "restrict_public_buckets": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "restrict_public_buckets", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "resource", "name": "aws_s3_bucket.this", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_56", "bc_check_id": null, "check_name": "Ensure S3 bucket has 'restrict_public_bucket' enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[427, "resource \"aws_s3_bucket_public_access_block\" \"this\" {\n"], [428, "  count = local.create_bucket && var.attach_public_policy ? 1 : 0\n"], [429, "\n"], [430, "  # Chain resources (s3_bucket -> s3_bucket_policy -> s3_bucket_public_access_block)\n"], [431, "  # to prevent \"A conflicting conditional operation is currently in progress against this resource.\"\n"], [432, "  # Ref: https://github.com/hashicorp/terraform-provider-aws/issues/7628\n"], [433, "\n"], [434, "  bucket = local.attach_policy ? aws_s3_bucket_policy.this[0].id : aws_s3_bucket.this[0].id\n"], [435, "\n"], [436, "  block_public_acls       = var.block_public_acls\n"], [437, "  block_public_policy     = var.block_public_policy\n"], [438, "  ignore_public_acls      = var.ignore_public_acls\n"], [439, "  restrict_public_buckets = var.restrict_public_buckets\n"], [440, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [427, 440], "resource": "module.log_bucket.aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_policy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "ignore_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "ignore_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "restrict_public_buckets": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "restrict_public_buckets", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "resource", "name": "aws_s3_bucket.this", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_53", "bc_check_id": null, "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[427, "resource \"aws_s3_bucket_public_access_block\" \"this\" {\n"], [428, "  count = local.create_bucket && var.attach_public_policy ? 1 : 0\n"], [429, "\n"], [430, "  # Chain resources (s3_bucket -> s3_bucket_policy -> s3_bucket_public_access_block)\n"], [431, "  # to prevent \"A conflicting conditional operation is currently in progress against this resource.\"\n"], [432, "  # Ref: https://github.com/hashicorp/terraform-provider-aws/issues/7628\n"], [433, "\n"], [434, "  bucket = local.attach_policy ? aws_s3_bucket_policy.this[0].id : aws_s3_bucket.this[0].id\n"], [435, "\n"], [436, "  block_public_acls       = var.block_public_acls\n"], [437, "  block_public_policy     = var.block_public_policy\n"], [438, "  ignore_public_acls      = var.ignore_public_acls\n"], [439, "  restrict_public_buckets = var.restrict_public_buckets\n"], [440, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [427, 440], "resource": "module.log_bucket.aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_policy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "ignore_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "ignore_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "restrict_public_buckets": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "restrict_public_buckets", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "resource", "name": "aws_s3_bucket.this", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_54", "bc_check_id": null, "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[427, "resource \"aws_s3_bucket_public_access_block\" \"this\" {\n"], [428, "  count = local.create_bucket && var.attach_public_policy ? 1 : 0\n"], [429, "\n"], [430, "  # Chain resources (s3_bucket -> s3_bucket_policy -> s3_bucket_public_access_block)\n"], [431, "  # to prevent \"A conflicting conditional operation is currently in progress against this resource.\"\n"], [432, "  # Ref: https://github.com/hashicorp/terraform-provider-aws/issues/7628\n"], [433, "\n"], [434, "  bucket = local.attach_policy ? aws_s3_bucket_policy.this[0].id : aws_s3_bucket.this[0].id\n"], [435, "\n"], [436, "  block_public_acls       = var.block_public_acls\n"], [437, "  block_public_policy     = var.block_public_policy\n"], [438, "  ignore_public_acls      = var.ignore_public_acls\n"], [439, "  restrict_public_buckets = var.restrict_public_buckets\n"], [440, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [427, 440], "resource": "module.log_bucket.aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 75], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_policy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "ignore_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "ignore_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "restrict_public_buckets": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "restrict_public_buckets", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "resource", "name": "aws_s3_bucket.this", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_143", "bc_check_id": null, "check_name": "Ensure that S3 bucket has lock configuration enabled by default", "check_result": {"result": "FAILED", "evaluated_keys": ["object_lock_configuration/[0]/object_lock_enabled"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.cloudfront_log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BucketObjectLock", "fixed_definition": null, "entity_tags": {}, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_55", "bc_check_id": null, "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[427, "resource \"aws_s3_bucket_public_access_block\" \"this\" {\n"], [428, "  count = local.create_bucket && var.attach_public_policy ? 1 : 0\n"], [429, "\n"], [430, "  # Chain resources (s3_bucket -> s3_bucket_policy -> s3_bucket_public_access_block)\n"], [431, "  # to prevent \"A conflicting conditional operation is currently in progress against this resource.\"\n"], [432, "  # Ref: https://github.com/hashicorp/terraform-provider-aws/issues/7628\n"], [433, "\n"], [434, "  bucket = local.attach_policy ? aws_s3_bucket_policy.this[0].id : aws_s3_bucket.this[0].id\n"], [435, "\n"], [436, "  block_public_acls       = var.block_public_acls\n"], [437, "  block_public_policy     = var.block_public_policy\n"], [438, "  ignore_public_acls      = var.ignore_public_acls\n"], [439, "  restrict_public_buckets = var.restrict_public_buckets\n"], [440, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [427, 440], "resource": "module.cloudfront_log_bucket.aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_policy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "ignore_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "ignore_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "restrict_public_buckets": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "restrict_public_buckets", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "resource", "name": "aws_s3_bucket.this", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_56", "bc_check_id": null, "check_name": "Ensure S3 bucket has 'restrict_public_bucket' enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[427, "resource \"aws_s3_bucket_public_access_block\" \"this\" {\n"], [428, "  count = local.create_bucket && var.attach_public_policy ? 1 : 0\n"], [429, "\n"], [430, "  # Chain resources (s3_bucket -> s3_bucket_policy -> s3_bucket_public_access_block)\n"], [431, "  # to prevent \"A conflicting conditional operation is currently in progress against this resource.\"\n"], [432, "  # Ref: https://github.com/hashicorp/terraform-provider-aws/issues/7628\n"], [433, "\n"], [434, "  bucket = local.attach_policy ? aws_s3_bucket_policy.this[0].id : aws_s3_bucket.this[0].id\n"], [435, "\n"], [436, "  block_public_acls       = var.block_public_acls\n"], [437, "  block_public_policy     = var.block_public_policy\n"], [438, "  ignore_public_acls      = var.ignore_public_acls\n"], [439, "  restrict_public_buckets = var.restrict_public_buckets\n"], [440, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [427, 440], "resource": "module.cloudfront_log_bucket.aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_policy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "ignore_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "ignore_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "restrict_public_buckets": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "restrict_public_buckets", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "resource", "name": "aws_s3_bucket.this", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_53", "bc_check_id": null, "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[427, "resource \"aws_s3_bucket_public_access_block\" \"this\" {\n"], [428, "  count = local.create_bucket && var.attach_public_policy ? 1 : 0\n"], [429, "\n"], [430, "  # Chain resources (s3_bucket -> s3_bucket_policy -> s3_bucket_public_access_block)\n"], [431, "  # to prevent \"A conflicting conditional operation is currently in progress against this resource.\"\n"], [432, "  # Ref: https://github.com/hashicorp/terraform-provider-aws/issues/7628\n"], [433, "\n"], [434, "  bucket = local.attach_policy ? aws_s3_bucket_policy.this[0].id : aws_s3_bucket.this[0].id\n"], [435, "\n"], [436, "  block_public_acls       = var.block_public_acls\n"], [437, "  block_public_policy     = var.block_public_policy\n"], [438, "  ignore_public_acls      = var.ignore_public_acls\n"], [439, "  restrict_public_buckets = var.restrict_public_buckets\n"], [440, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [427, 440], "resource": "module.cloudfront_log_bucket.aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_policy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "ignore_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "ignore_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "restrict_public_buckets": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "restrict_public_buckets", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "resource", "name": "aws_s3_bucket.this", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_54", "bc_check_id": null, "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[427, "resource \"aws_s3_bucket_public_access_block\" \"this\" {\n"], [428, "  count = local.create_bucket && var.attach_public_policy ? 1 : 0\n"], [429, "\n"], [430, "  # Chain resources (s3_bucket -> s3_bucket_policy -> s3_bucket_public_access_block)\n"], [431, "  # to prevent \"A conflicting conditional operation is currently in progress against this resource.\"\n"], [432, "  # Ref: https://github.com/hashicorp/terraform-provider-aws/issues/7628\n"], [433, "\n"], [434, "  bucket = local.attach_policy ? aws_s3_bucket_policy.this[0].id : aws_s3_bucket.this[0].id\n"], [435, "\n"], [436, "  block_public_acls       = var.block_public_acls\n"], [437, "  block_public_policy     = var.block_public_policy\n"], [438, "  ignore_public_acls      = var.ignore_public_acls\n"], [439, "  restrict_public_buckets = var.restrict_public_buckets\n"], [440, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [427, 440], "resource": "module.cloudfront_log_bucket.aws_s3_bucket_public_access_block.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [77, 93], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"count": [{"type": "variable", "name": "attach_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "block_public_policy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "block_public_policy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "ignore_public_acls": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "ignore_public_acls", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "restrict_public_buckets": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "restrict_public_buckets", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "resource", "name": "aws_s3_bucket.this", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_143", "bc_check_id": null, "check_name": "Ensure that S3 bucket has lock configuration enabled by default", "check_result": {"result": "FAILED", "evaluated_keys": ["object_lock_configuration/[0]/object_lock_enabled"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.s3_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BucketObjectLock", "fixed_definition": null, "entity_tags": {"Owner": "Anton"}, "caller_file_path": "/main.tf", "caller_file_line_range": [95, 235], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_21", "bc_check_id": null, "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["private"], "bucket": ["s3-bucket-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{"Owner": "Anton"}], "__address__": "module.s3_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["versioning_configuration/status", "versioning/enabled", "resource_type"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.s3_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Owner": "Anton"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_21", "bc_check_id": null, "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["log-delivery-write"], "bucket": ["logs-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{}], "__address__": "module.log_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["versioning_configuration/status", "versioning/enabled", "resource_type"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_21", "bc_check_id": null, "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["var.acl"], "bucket": ["cloudfront-logs-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{}], "__address__": "module.cloudfront_log_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["versioning_configuration/status", "versioning/enabled", "resource_type"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.cloudfront_log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_6", "bc_check_id": null, "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["log-delivery-write"], "bucket": ["logs-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{}], "__address__": "module.log_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["block_public_policy", "resource_type", "block_public_acls"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV2_AWS_6", "bc_check_id": null, "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["var.acl"], "bucket": ["cloudfront-logs-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{}], "__address__": "module.cloudfront_log_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["block_public_policy", "resource_type", "block_public_acls"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.cloudfront_log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_145", "bc_check_id": null, "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["private"], "bucket": ["s3-bucket-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{"Owner": "Anton"}], "__address__": "module.s3_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.s3_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Owner": "Anton"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_145", "bc_check_id": null, "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["log-delivery-write"], "bucket": ["logs-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{}], "__address__": "module.log_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_145", "bc_check_id": null, "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["var.acl"], "bucket": ["cloudfront-logs-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{}], "__address__": "module.cloudfront_log_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.cloudfront_log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": null, "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["private"], "bucket": ["s3-bucket-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{"Owner": "Anton"}], "__address__": "module.s3_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.s3_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Owner": "Anton"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": null, "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["log-delivery-write"], "bucket": ["logs-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{}], "__address__": "module.log_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": null, "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["var.acl"], "bucket": ["cloudfront-logs-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{}], "__address__": "module.cloudfront_log_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.cloudfront_log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_19", "bc_check_id": null, "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["private"], "bucket": ["s3-bucket-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{"Owner": "Anton"}], "__address__": "module.s3_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.s3_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Owner": "Anton"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#2]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_19", "bc_check_id": null, "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["log-delivery-write"], "bucket": ["logs-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{}], "__address__": "module.log_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#0]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}, {"check_id": "CKV_AWS_19", "bc_check_id": null, "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 265, "__start_line__": 7, "acceleration_status": ["var.acceleration_status"], "acl": ["var.acl"], "bucket": ["cloudfront-logs-${random_pet.this.id}"], "bucket_prefix": ["var.bucket_prefix"], "count": [1], "dynamic": [{"website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}]}, {"cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}]}, {"versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}]}, {"logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}]}, {"grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}]}, {"lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}]}, {"replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}]}, {"server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}]}, {"object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}], "force_destroy": [true], "request_payer": ["var.request_payer"], "tags": [{}], "__address__": "module.cloudfront_log_bucket.aws_s3_bucket.this", "website": [{"error_document": ["lookup(website.value,\"error_document\",None)"], "index_document": ["lookup(website.value,\"index_document\",None)"], "redirect_all_requests_to": ["lookup(website.value,\"redirect_all_requests_to\",None)"], "routing_rules": ["lookup(website.value,\"routing_rules\",None)"]}], "cors_rule": [{"allowed_headers": ["lookup(cors_rule.value,\"allowed_headers\",None)"], "allowed_methods": ["cors_rule.value.allowed_methods"], "allowed_origins": ["cors_rule.value.allowed_origins"], "expose_headers": ["lookup(cors_rule.value,\"expose_headers\",None)"], "max_age_seconds": ["lookup(cors_rule.value,\"max_age_seconds\",None)"]}], "versioning": [{"enabled": ["lookup(versioning.value,\"enabled\",None)"], "mfa_delete": ["lookup(versioning.value,\"mfa_delete\",None)"]}], "logging": [{"target_bucket": ["logging.value.target_bucket"], "target_prefix": ["lookup(logging.value,\"target_prefix\",None)"]}], "grant": [{"id": ["lookup(grant.value,\"id\",None)"], "permissions": ["grant.value.permissions"], "type": ["grant.value.type"], "uri": ["lookup(grant.value,\"uri\",None)"]}], "lifecycle_rule": [{"abort_incomplete_multipart_upload_days": ["lookup(lifecycle_rule.value,\"abort_incomplete_multipart_upload_days\",None)"], "dynamic": [{"expiration": {"content": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"expiration\",{})"]]}}, {"transition": {"content": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"transition\",[])"]}}, {"noncurrent_version_expiration": {"content": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "for_each": [["lookup(lifecycle_rule.value,\"noncurrent_version_expiration\",{})"]]}}, {"noncurrent_version_transition": {"content": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}], "for_each": ["lookup(lifecycle_rule.value,\"noncurrent_version_transition\",[])"]}}], "enabled": ["lifecycle_rule.value.enabled"], "id": ["lookup(lifecycle_rule.value,\"id\",None)"], "prefix": ["lookup(lifecycle_rule.value,\"prefix\",None)"], "tags": ["lookup(lifecycle_rule.value,\"tags\",None)"], "expiration": [{"date": ["lookup(expiration.value,\"date\",None)"], "days": ["lookup(expiration.value,\"days\",None)"], "expired_object_delete_marker": ["lookup(expiration.value,\"expired_object_delete_marker\",None)"]}], "transition": [{"date": ["lookup(transition.value,\"date\",None)"], "days": ["lookup(transition.value,\"days\",None)"], "storage_class": ["transition.value.storage_class"]}], "noncurrent_version_expiration": [{"days": ["lookup(noncurrent_version_expiration.value,\"days\",None)"]}], "noncurrent_version_transition": [{"days": ["lookup(noncurrent_version_transition.value,\"days\",None)"], "storage_class": ["noncurrent_version_transition.value.storage_class"]}]}], "replication_configuration": [{"dynamic": [{"rules": {"content": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}], "for_each": ["replication_configuration.value.rules"]}}], "role": ["replication_configuration.value.role"], "rules": [{"delete_marker_replication_status": ["lookup(rules.value,\"delete_marker_replication_status\",None)"], "dynamic": [{"destination": {"content": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "for_each": [["lookup(rules.value,\"destination\",{})"]]}}, {"source_selection_criteria": {"content": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "for_each": [["lookup(rules.value,\"source_selection_criteria\",{})"]]}}, {"filter": {"content": [{}], "for_each": [[]]}}, {"filter": {"content": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}], "for_each": [["lookup(rules.value,\"filter\",{})"]]}}], "id": ["lookup(rules.value,\"id\",None)"], "prefix": ["lookup(rules.value,\"prefix\",None)"], "priority": ["lookup(rules.value,\"priority\",None)"], "status": ["rules.value.status"], "destination": [{"account_id": ["lookup(destination.value,\"account_id\",None)"], "bucket": ["destination.value.bucket"], "dynamic": [{"access_control_translation": {"content": [{"owner": ["access_control_translation.value.owner"]}], "for_each": [["lookup(destination.value,\"access_control_translation\",{})"]]}}, {"replication_time": {"content": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "for_each": [["lookup(destination.value,\"replication_time\",{})"]]}}, {"metrics": {"content": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}], "for_each": [["lookup(destination.value,\"metrics\",{})"]]}}], "replica_kms_key_id": ["lookup(destination.value,\"replica_kms_key_id\",None)"], "storage_class": ["lookup(destination.value,\"storage_class\",None)"], "access_control_translation": [{"owner": ["access_control_translation.value.owner"]}], "replication_time": [{"minutes": ["replication_time.value.minutes"], "status": ["replication_time.value.status"]}], "metrics": [{"minutes": ["metrics.value.minutes"], "status": ["metrics.value.status"]}]}], "source_selection_criteria": [{"dynamic": [{"sse_kms_encrypted_objects": {"content": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}], "for_each": [["lookup(source_selection_criteria.value,\"sse_kms_encrypted_objects\",{})"]]}}], "sse_kms_encrypted_objects": [{"enabled": ["sse_kms_encrypted_objects.value.enabled"]}]}], "filter": [{"prefix": ["lookup(filter.value,\"prefix\",None)"], "tags": ["lookup(filter.value,\"tags\",None)"]}]}]}], "server_side_encryption_configuration": [{"dynamic": [{"rule": {"content": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}], "for_each": [["lookup(server_side_encryption_configuration.value,\"rule\",{})"]]}}], "rule": [{"bucket_key_enabled": ["lookup(rule.value,\"bucket_key_enabled\",None)"], "dynamic": [{"apply_server_side_encryption_by_default": {"content": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}], "for_each": [["lookup(rule.value,\"apply_server_side_encryption_by_default\",{})"]]}}], "apply_server_side_encryption_by_default": [{"kms_master_key_id": ["lookup(apply_server_side_encryption_by_default.value,\"kms_master_key_id\",None)"], "sse_algorithm": ["apply_server_side_encryption_by_default.value.sse_algorithm"]}]}]}], "object_lock_configuration": [{"dynamic": [{"rule": {"content": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}], "for_each": [["lookup(object_lock_configuration.value,\"rule\",{})"]]}}], "object_lock_enabled": ["object_lock_configuration.value.object_lock_enabled"], "rule": [{"default_retention": [{"days": ["lookup(lookup(rule.value,\"default_retention\",{}),\"days\",None)"], "mode": ["lookup(lookup(rule.value,\"default_retention\",{}),\"mode\")"], "years": ["lookup(lookup(rule.value,\"default_retention\",{}),\"years\",None)"]}]}]}]}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[7, "resource \"aws_s3_bucket\" \"this\" {\n"], [8, "  count = local.create_bucket ? 1 : 0\n"], [9, "\n"], [10, "  bucket        = var.bucket\n"], [11, "  bucket_prefix = var.bucket_prefix\n"], [12, "\n"], [13, "  # hack when `null` value can't be used (eg, from terragrunt, https://github.com/gruntwork-io/terragrunt/pull/1367)\n"], [14, "  acl = var.acl != \"null\" ? var.acl : null\n"], [15, "\n"], [16, "  tags                = var.tags\n"], [17, "  force_destroy       = var.force_destroy\n"], [18, "  acceleration_status = var.acceleration_status\n"], [19, "  request_payer       = var.request_payer\n"], [20, "\n"], [21, "  dynamic \"website\" {\n"], [22, "    for_each = length(keys(var.website)) == 0 ? [] : [var.website]\n"], [23, "\n"], [24, "    content {\n"], [25, "      index_document           = lookup(website.value, \"index_document\", null)\n"], [26, "      error_document           = lookup(website.value, \"error_document\", null)\n"], [27, "      redirect_all_requests_to = lookup(website.value, \"redirect_all_requests_to\", null)\n"], [28, "      routing_rules            = lookup(website.value, \"routing_rules\", null)\n"], [29, "    }\n"], [30, "  }\n"], [31, "\n"], [32, "  dynamic \"cors_rule\" {\n"], [33, "    for_each = try(jsondecode(var.cors_rule), var.cors_rule)\n"], [34, "\n"], [35, "    content {\n"], [36, "      allowed_methods = cors_rule.value.allowed_methods\n"], [37, "      allowed_origins = cors_rule.value.allowed_origins\n"], [38, "      allowed_headers = lookup(cors_rule.value, \"allowed_headers\", null)\n"], [39, "      expose_headers  = lookup(cors_rule.value, \"expose_headers\", null)\n"], [40, "      max_age_seconds = lookup(cors_rule.value, \"max_age_seconds\", null)\n"], [41, "    }\n"], [42, "  }\n"], [43, "\n"], [44, "  dynamic \"versioning\" {\n"], [45, "    for_each = length(keys(var.versioning)) == 0 ? [] : [var.versioning]\n"], [46, "\n"], [47, "    content {\n"], [48, "      enabled    = lookup(versioning.value, \"enabled\", null)\n"], [49, "      mfa_delete = lookup(versioning.value, \"mfa_delete\", null)\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  dynamic \"logging\" {\n"], [54, "    for_each = length(keys(var.logging)) == 0 ? [] : [var.logging]\n"], [55, "\n"], [56, "    content {\n"], [57, "      target_bucket = logging.value.target_bucket\n"], [58, "      target_prefix = lookup(logging.value, \"target_prefix\", null)\n"], [59, "    }\n"], [60, "  }\n"], [61, "\n"], [62, "  dynamic \"grant\" {\n"], [63, "    for_each = try(jsondecode(var.grant), var.grant)\n"], [64, "\n"], [65, "    content {\n"], [66, "      id          = lookup(grant.value, \"id\", null)\n"], [67, "      type        = grant.value.type\n"], [68, "      permissions = grant.value.permissions\n"], [69, "      uri         = lookup(grant.value, \"uri\", null)\n"], [70, "    }\n"], [71, "  }\n"], [72, "\n"], [73, "  dynamic \"lifecycle_rule\" {\n"], [74, "    for_each = try(jsondecode(var.lifecycle_rule), var.lifecycle_rule)\n"], [75, "\n"], [76, "    content {\n"], [77, "      id                                     = lookup(lifecycle_rule.value, \"id\", null)\n"], [78, "      prefix                                 = lookup(lifecycle_rule.value, \"prefix\", null)\n"], [79, "      tags                                   = lookup(lifecycle_rule.value, \"tags\", null)\n"], [80, "      abort_incomplete_multipart_upload_days = lookup(lifecycle_rule.value, \"abort_incomplete_multipart_upload_days\", null)\n"], [81, "      enabled                                = lifecycle_rule.value.enabled\n"], [82, "\n"], [83, "      # Max 1 block - expiration\n"], [84, "      dynamic \"expiration\" {\n"], [85, "        for_each = length(keys(lookup(lifecycle_rule.value, \"expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"expiration\", {})]\n"], [86, "\n"], [87, "        content {\n"], [88, "          date                         = lookup(expiration.value, \"date\", null)\n"], [89, "          days                         = lookup(expiration.value, \"days\", null)\n"], [90, "          expired_object_delete_marker = lookup(expiration.value, \"expired_object_delete_marker\", null)\n"], [91, "        }\n"], [92, "      }\n"], [93, "\n"], [94, "      # Several blocks - transition\n"], [95, "      dynamic \"transition\" {\n"], [96, "        for_each = lookup(lifecycle_rule.value, \"transition\", [])\n"], [97, "\n"], [98, "        content {\n"], [99, "          date          = lookup(transition.value, \"date\", null)\n"], [100, "          days          = lookup(transition.value, \"days\", null)\n"], [101, "          storage_class = transition.value.storage_class\n"], [102, "        }\n"], [103, "      }\n"], [104, "\n"], [105, "      # Max 1 block - noncurrent_version_expiration\n"], [106, "      dynamic \"noncurrent_version_expiration\" {\n"], [107, "        for_each = length(keys(lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {}))) == 0 ? [] : [lookup(lifecycle_rule.value, \"noncurrent_version_expiration\", {})]\n"], [108, "\n"], [109, "        content {\n"], [110, "          days = lookup(noncurrent_version_expiration.value, \"days\", null)\n"], [111, "        }\n"], [112, "      }\n"], [113, "\n"], [114, "      # Several blocks - noncurrent_version_transition\n"], [115, "      dynamic \"noncurrent_version_transition\" {\n"], [116, "        for_each = lookup(lifecycle_rule.value, \"noncurrent_version_transition\", [])\n"], [117, "\n"], [118, "        content {\n"], [119, "          days          = lookup(noncurrent_version_transition.value, \"days\", null)\n"], [120, "          storage_class = noncurrent_version_transition.value.storage_class\n"], [121, "        }\n"], [122, "      }\n"], [123, "    }\n"], [124, "  }\n"], [125, "\n"], [126, "  # Max 1 block - replication_configuration\n"], [127, "  dynamic \"replication_configuration\" {\n"], [128, "    for_each = length(keys(var.replication_configuration)) == 0 ? [] : [var.replication_configuration]\n"], [129, "\n"], [130, "    content {\n"], [131, "      role = replication_configuration.value.role\n"], [132, "\n"], [133, "      dynamic \"rules\" {\n"], [134, "        for_each = replication_configuration.value.rules\n"], [135, "\n"], [136, "        content {\n"], [137, "          id                               = lookup(rules.value, \"id\", null)\n"], [138, "          priority                         = lookup(rules.value, \"priority\", null)\n"], [139, "          prefix                           = lookup(rules.value, \"prefix\", null)\n"], [140, "          delete_marker_replication_status = lookup(rules.value, \"delete_marker_replication_status\", null)\n"], [141, "          status                           = rules.value.status\n"], [142, "\n"], [143, "          dynamic \"destination\" {\n"], [144, "            for_each = length(keys(lookup(rules.value, \"destination\", {}))) == 0 ? [] : [lookup(rules.value, \"destination\", {})]\n"], [145, "\n"], [146, "            content {\n"], [147, "              bucket             = destination.value.bucket\n"], [148, "              storage_class      = lookup(destination.value, \"storage_class\", null)\n"], [149, "              replica_kms_key_id = lookup(destination.value, \"replica_kms_key_id\", null)\n"], [150, "              account_id         = lookup(destination.value, \"account_id\", null)\n"], [151, "\n"], [152, "              dynamic \"access_control_translation\" {\n"], [153, "                for_each = length(keys(lookup(destination.value, \"access_control_translation\", {}))) == 0 ? [] : [lookup(destination.value, \"access_control_translation\", {})]\n"], [154, "\n"], [155, "                content {\n"], [156, "                  owner = access_control_translation.value.owner\n"], [157, "                }\n"], [158, "              }\n"], [159, "\n"], [160, "              dynamic \"replication_time\" {\n"], [161, "                for_each = length(keys(lookup(destination.value, \"replication_time\", {}))) == 0 ? [] : [lookup(destination.value, \"replication_time\", {})]\n"], [162, "\n"], [163, "                content {\n"], [164, "                  status  = replication_time.value.status\n"], [165, "                  minutes = replication_time.value.minutes\n"], [166, "                }\n"], [167, "              }\n"], [168, "\n"], [169, "              dynamic \"metrics\" {\n"], [170, "                for_each = length(keys(lookup(destination.value, \"metrics\", {}))) == 0 ? [] : [lookup(destination.value, \"metrics\", {})]\n"], [171, "\n"], [172, "                content {\n"], [173, "                  status  = metrics.value.status\n"], [174, "                  minutes = metrics.value.minutes\n"], [175, "                }\n"], [176, "              }\n"], [177, "            }\n"], [178, "          }\n"], [179, "\n"], [180, "          dynamic \"source_selection_criteria\" {\n"], [181, "            for_each = length(keys(lookup(rules.value, \"source_selection_criteria\", {}))) == 0 ? [] : [lookup(rules.value, \"source_selection_criteria\", {})]\n"], [182, "\n"], [183, "            content {\n"], [184, "\n"], [185, "              dynamic \"sse_kms_encrypted_objects\" {\n"], [186, "                for_each = length(keys(lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {}))) == 0 ? [] : [lookup(source_selection_criteria.value, \"sse_kms_encrypted_objects\", {})]\n"], [187, "\n"], [188, "                content {\n"], [189, "\n"], [190, "                  enabled = sse_kms_encrypted_objects.value.enabled\n"], [191, "                }\n"], [192, "              }\n"], [193, "            }\n"], [194, "          }\n"], [195, "\n"], [196, "          # Send empty map if `filter` is an empty map or absent entirely\n"], [197, "          dynamic \"filter\" {\n"], [198, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) == 0 ? [{}] : []\n"], [199, "\n"], [200, "            content {}\n"], [201, "          }\n"], [202, "\n"], [203, "          # Send `filter` if it is present and has at least one field\n"], [204, "          dynamic \"filter\" {\n"], [205, "            for_each = length(keys(lookup(rules.value, \"filter\", {}))) != 0 ? [lookup(rules.value, \"filter\", {})] : []\n"], [206, "\n"], [207, "            content {\n"], [208, "              prefix = lookup(filter.value, \"prefix\", null)\n"], [209, "              tags   = lookup(filter.value, \"tags\", null)\n"], [210, "            }\n"], [211, "          }\n"], [212, "\n"], [213, "        }\n"], [214, "      }\n"], [215, "    }\n"], [216, "  }\n"], [217, "\n"], [218, "  # Max 1 block - server_side_encryption_configuration\n"], [219, "  dynamic \"server_side_encryption_configuration\" {\n"], [220, "    for_each = length(keys(var.server_side_encryption_configuration)) == 0 ? [] : [var.server_side_encryption_configuration]\n"], [221, "\n"], [222, "    content {\n"], [223, "\n"], [224, "      dynamic \"rule\" {\n"], [225, "        for_each = length(keys(lookup(server_side_encryption_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(server_side_encryption_configuration.value, \"rule\", {})]\n"], [226, "\n"], [227, "        content {\n"], [228, "          bucket_key_enabled = lookup(rule.value, \"bucket_key_enabled\", null)\n"], [229, "\n"], [230, "          dynamic \"apply_server_side_encryption_by_default\" {\n"], [231, "            for_each = length(keys(lookup(rule.value, \"apply_server_side_encryption_by_default\", {}))) == 0 ? [] : [\n"], [232, "            lookup(rule.value, \"apply_server_side_encryption_by_default\", {})]\n"], [233, "\n"], [234, "            content {\n"], [235, "              sse_algorithm     = apply_server_side_encryption_by_default.value.sse_algorithm\n"], [236, "              kms_master_key_id = lookup(apply_server_side_encryption_by_default.value, \"kms_master_key_id\", null)\n"], [237, "            }\n"], [238, "          }\n"], [239, "        }\n"], [240, "      }\n"], [241, "    }\n"], [242, "  }\n"], [243, "\n"], [244, "  # Max 1 block - object_lock_configuration\n"], [245, "  dynamic \"object_lock_configuration\" {\n"], [246, "    for_each = length(keys(var.object_lock_configuration)) == 0 ? [] : [var.object_lock_configuration]\n"], [247, "\n"], [248, "    content {\n"], [249, "      object_lock_enabled = object_lock_configuration.value.object_lock_enabled\n"], [250, "\n"], [251, "      dynamic \"rule\" {\n"], [252, "        for_each = length(keys(lookup(object_lock_configuration.value, \"rule\", {}))) == 0 ? [] : [lookup(object_lock_configuration.value, \"rule\", {})]\n"], [253, "\n"], [254, "        content {\n"], [255, "          default_retention {\n"], [256, "            mode  = lookup(lookup(rule.value, \"default_retention\", {}), \"mode\")\n"], [257, "            days  = lookup(lookup(rule.value, \"default_retention\", {}), \"days\", null)\n"], [258, "            years = lookup(lookup(rule.value, \"default_retention\", {}), \"years\", null)\n"], [259, "          }\n"], [260, "        }\n"], [261, "      }\n"], [262, "    }\n"], [263, "  }\n"], [264, "\n"], [265, "}\n"]], "file_path": "/../../main.tf", "file_abs_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "repo_file_path": "/main.tf", "file_line_range": [7, 265], "resource": "module.cloudfront_log_bucket.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf[/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf#1]", "breadcrumbs": {"dynamic.4.grant.for_each": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.id": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.permissions": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.type": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "grant.uri": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4.grant": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.4": [{"type": "variable", "name": "grant", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration.for_each": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.delete_marker_replication_status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.id": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.prefix": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.priority": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.rules.status": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "replication_configuration.role": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6.replication_configuration": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.6": [{"type": "variable", "name": "replication_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "count": [{"type": "variable", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}, {"type": "locals", "name": "create_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/main.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "server_side_encryption_configuration.rule.bucket_key_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.kms_master_key_id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "rule.apply_server_side_encryption_by_default.sse_algorithm": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7.server_side_encryption_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.7": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "server_side_encryption_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "acl": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "acl", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "force_destroy": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "force_destroy", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.error_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.index_document": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.redirect_all_requests_to": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "website.routing_rules": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0.website": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.0": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "website", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.abort_incomplete_multipart_upload_days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.id": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "lifecycle_rule.tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5.lifecycle_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.5": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "lifecycle_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "versioning.mfa_delete": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2.versioning": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "versioning", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "logging.target_prefix": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3.logging": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "logging", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_methods": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.allowed_origins": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.expose_headers": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "cors_rule.max_age_seconds": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1.cors_rule": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "cors_rule", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "tags": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "tags", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration.for_each": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.days": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.mode": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.rule.default_retention.years": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "object_lock_configuration.object_lock_enabled": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8.object_lock_configuration": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "dynamic.8": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "module_connection": false}, {"type": "variable", "name": "object_lock_configuration", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3_bucket", "path": "/iac/terraform_main/.external_modules/github.com/terraform-aws-modules/terraform-aws-lambda/v2.36.0/.external_modules/github.com/terraform-aws-modules/terraform-aws-s3-bucket/v2.15.0/examples/complete/main.tf", "idx": 9}]}}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 126, "failed": 26, "skipped": 0, "parsing_errors": 0, "resource_count": 7, "checkov_version": "2.2.278"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}
